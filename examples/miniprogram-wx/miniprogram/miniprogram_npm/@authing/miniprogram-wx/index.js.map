{"version":3,"sources":["bundle-wx.js"],"names":[],"mappings":";;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.js","sourcesContent":["/******/ var __webpack_modules__ = ([\n/* 0 */,\n/* 1 */\n/***/ ((__unused_webpack_module, __authing_webpack_exports__, __authing_webpack_require__) => {\n\n  __authing_webpack_require__.r(__authing_webpack_exports__);\n  /* harmony export */ __authing_webpack_require__.d(__authing_webpack_exports__, {\n  /* harmony export */   \"Core\": () => (/* binding */ Core)\n  /* harmony export */ });\n  /* harmony import */ var _helpers__WEBPACK_IMPORTED_MODULE_0__ = __authing_webpack_require__(2);\n  /* harmony import */ var _Base__WEBPACK_IMPORTED_MODULE_1__ = __authing_webpack_require__(25);\n  var __extends = (undefined && undefined.__extends) || (function () {\n      var extendStatics = function (d, b) {\n          extendStatics = Object.setPrototypeOf ||\n              ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n              function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n          return extendStatics(d, b);\n      };\n      return function (d, b) {\n          if (typeof b !== \"function\" && b !== null)\n              throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n          extendStatics(d, b);\n          function __() { this.constructor = d; }\n          d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n      };\n  })();\n  var __assign = (undefined && undefined.__assign) || function () {\n      __assign = Object.assign || function(t) {\n          for (var s, i = 1, n = arguments.length; i < n; i++) {\n              s = arguments[i];\n              for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                  t[p] = s[p];\n          }\n          return t;\n      };\n      return __assign.apply(this, arguments);\n  };\n  var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\n      function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n      return new (P || (P = Promise))(function (resolve, reject) {\n          function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n          function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n          function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n          step((generator = generator.apply(thisArg, _arguments || [])).next());\n      });\n  };\n  var __generator = (undefined && undefined.__generator) || function (thisArg, body) {\n      var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n      return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n      function verb(n) { return function (v) { return step([n, v]); }; }\n      function step(op) {\n          if (f) throw new TypeError(\"Generator is already executing.\");\n          while (_) try {\n              if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n              if (y = 0, t) op = [op[0] & 2, t.value];\n              switch (op[0]) {\n                  case 0: case 1: t = op; break;\n                  case 4: _.label++; return { value: op[1], done: false };\n                  case 5: _.label++; y = op[1]; op = [0]; continue;\n                  case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                  default:\n                      if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                      if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                      if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                      if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                      if (t[2]) _.ops.pop();\n                      _.trys.pop(); continue;\n              }\n              op = body.call(thisArg, _);\n          } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n          if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n      }\n  };\n  \n  \n  var Core = /** @class */ (function (_super) {\n      __extends(Core, _super);\n      function Core(options) {\n          return _super.call(this, options) || this;\n      }\n      Core.prototype.loginByCode = function (data) {\n          return __awaiter(this, void 0, void 0, function () {\n              var _data;\n              return __generator(this, function (_a) {\n                  switch (_a.label) {\n                      case 0:\n                          _data = __assign(__assign({}, data), { connection: 'wechat_mini_program_code' });\n                          return [4 /*yield*/, this.login(_data, 'code')];\n                      case 1: return [2 /*return*/, _a.sent()];\n                  }\n              });\n          });\n      };\n      Core.prototype.loginByPhone = function (data) {\n          return __awaiter(this, void 0, void 0, function () {\n              var _data;\n              return __generator(this, function (_a) {\n                  switch (_a.label) {\n                      case 0:\n                          _data = __assign(__assign({}, data), { connection: 'wechat_mini_program_phone' });\n                          return [4 /*yield*/, this.login(_data, 'phone')];\n                      case 1: return [2 /*return*/, _a.sent()];\n                  }\n              });\n          });\n      };\n      Core.prototype.loginByPassword = function (data) {\n          var _a, _b, _c;\n          return __awaiter(this, void 0, void 0, function () {\n              var publicKey, _data;\n              return __generator(this, function (_d) {\n                  switch (_d.label) {\n                      case 0:\n                          if (!(((_a = data.options) === null || _a === void 0 ? void 0 : _a.passwordEncryptType) &&\n                              ((_b = data.options) === null || _b === void 0 ? void 0 : _b.passwordEncryptType) !== 'none')) return [3 /*break*/, 2];\n                          if (!this.encryptFunction) {\n                              return [2 /*return*/, (0,_helpers__WEBPACK_IMPORTED_MODULE_0__.error)('loginByPassword', 'encryptFunction is requiered, if passwordEncryptType is not \"none\"')];\n                          }\n                          return [4 /*yield*/, this.getPublicKey((_c = data.options) === null || _c === void 0 ? void 0 : _c.passwordEncryptType)];\n                      case 1:\n                          publicKey = _d.sent();\n                          data.passwordPayload.password = this.encryptFunction(data.passwordPayload.password, publicKey);\n                          _d.label = 2;\n                      case 2:\n                          _data = __assign(__assign({}, data), { connection: 'PASSWORD' });\n                          return [4 /*yield*/, this.login(_data, 'password')];\n                      case 3: return [2 /*return*/, _d.sent()];\n                  }\n              });\n          });\n      };\n      Core.prototype.loginByPassCode = function (data) {\n          return __awaiter(this, void 0, void 0, function () {\n              var _data;\n              return __generator(this, function (_a) {\n                  switch (_a.label) {\n                      case 0:\n                          if (data.passCodePayload.phone) {\n                              data.passCodePayload.phoneCountryCode =\n                                  data.passCodePayload.phoneCountryCode || '+86';\n                          }\n                          _data = __assign(__assign({}, data), { connection: 'PASSCODE' });\n                          return [4 /*yield*/, this.login(_data, 'passCode')];\n                      case 1: return [2 /*return*/, _a.sent()];\n                  }\n              });\n          });\n      };\n      Core.prototype.logout = function () {\n          return __awaiter(this, void 0, void 0, function () {\n              var access_token, e_1;\n              return __generator(this, function (_a) {\n                  switch (_a.label) {\n                      case 0:\n                          _a.trys.push([0, 4, , 5]);\n                          return [4 /*yield*/, this.getLoginState()];\n                      case 1:\n                          access_token = (_a.sent()).access_token;\n                          return [4 /*yield*/, (0,_helpers__WEBPACK_IMPORTED_MODULE_0__.request)({\n                                  method: 'POST',\n                                  url: this.authingOptions.host + \"/oidc/token/revocation\",\n                                  data: {\n                                      client_id: this.authingOptions.appId,\n                                      token: access_token\n                                  }\n                              })];\n                      case 2:\n                          _a.sent();\n                          return [4 /*yield*/, this.clearLoginState()];\n                      case 3: return [2 /*return*/, _a.sent()];\n                      case 4:\n                          e_1 = _a.sent();\n                          (0,_helpers__WEBPACK_IMPORTED_MODULE_0__.error)('logout', e_1);\n                          return [3 /*break*/, 5];\n                      case 5: return [2 /*return*/];\n                  }\n              });\n          });\n      };\n      Core.prototype.sendSms = function (data) {\n          return __awaiter(this, void 0, void 0, function () {\n              return __generator(this, function (_a) {\n                  switch (_a.label) {\n                      case 0:\n                          data.phoneCountryCode = data.phoneCountryCode || '+86';\n                          return [4 /*yield*/, (0,_helpers__WEBPACK_IMPORTED_MODULE_0__.request)({\n                                  method: 'POST',\n                                  url: this.authingOptions.host + \"/api/v3/send-sms\",\n                                  data: data,\n                                  header: {\n                                      'x-authing-userpool-id': this.authingOptions.userPoolId\n                                  }\n                              })];\n                      case 1: return [2 /*return*/, _a.sent()];\n                  }\n              });\n          });\n      };\n      Core.prototype.login = function (data, type) {\n          return __awaiter(this, void 0, void 0, function () {\n              var urlMap, res, loginState;\n              return __generator(this, function (_a) {\n                  switch (_a.label) {\n                      case 0:\n                          urlMap = {\n                              code: '/api/v3/signin-by-mobile',\n                              phone: '/api/v3/signin-by-mobile',\n                              password: '/api/v3/signin',\n                              passCode: '/api/v3/signin'\n                          };\n                          return [4 /*yield*/, (0,_helpers__WEBPACK_IMPORTED_MODULE_0__.request)({\n                                  method: 'POST',\n                                  url: this.authingOptions.host + urlMap[type],\n                                  data: data,\n                                  header: {\n                                      'x-authing-app-id': this.authingOptions.appId\n                                  }\n                              })];\n                      case 1:\n                          res = _a.sent();\n                          if (!res.access_token) return [3 /*break*/, 3];\n                          return [4 /*yield*/, this.saveLoginState(res)];\n                      case 2:\n                          loginState = _a.sent();\n                          return [2 /*return*/, loginState];\n                      case 3: return [4 /*yield*/, this.clearLoginState()];\n                      case 4:\n                          _a.sent();\n                          return [2 /*return*/];\n                  }\n              });\n          });\n      };\n      Core.prototype.refreshToken = function () {\n          return __awaiter(this, void 0, void 0, function () {\n              var refresh_token, data, res, loginState;\n              return __generator(this, function (_a) {\n                  switch (_a.label) {\n                      case 0: return [4 /*yield*/, this.getLoginState()];\n                      case 1:\n                          refresh_token = (_a.sent()).refresh_token;\n                          if (!refresh_token) {\n                              return [2 /*return*/, (0,_helpers__WEBPACK_IMPORTED_MODULE_0__.error)('refreshToken', 'refresh_token must not be empty')];\n                          }\n                          data = {\n                              grant_type: 'refresh_token',\n                              redirect_uri: '',\n                              refresh_token: refresh_token\n                          };\n                          return [4 /*yield*/, (0,_helpers__WEBPACK_IMPORTED_MODULE_0__.request)({\n                                  method: 'POST',\n                                  url: this.authingOptions.host + \"/oidc/token\",\n                                  data: data,\n                                  header: {\n                                      'content-type': 'application/x-www-form-urlencoded',\n                                      'x-authing-app-id': this.authingOptions.appId\n                                  }\n                              })];\n                      case 2:\n                          res = _a.sent();\n                          if (!res.access_token) return [3 /*break*/, 4];\n                          return [4 /*yield*/, this.saveLoginState(res)];\n                      case 3:\n                          loginState = _a.sent();\n                          return [2 /*return*/, loginState];\n                      case 4: return [4 /*yield*/, this.clearLoginState()];\n                      case 5:\n                          _a.sent();\n                          return [2 /*return*/];\n                  }\n              });\n          });\n      };\n      Core.prototype.changeQrcodeStatus = function (data) {\n          return __awaiter(this, void 0, void 0, function () {\n              var _a, access_token, expires_at;\n              return __generator(this, function (_b) {\n                  switch (_b.label) {\n                      case 0: return [4 /*yield*/, this.getLoginState()];\n                      case 1:\n                          _a = _b.sent(), access_token = _a.access_token, expires_at = _a.expires_at;\n                          if (expires_at < Date.now()) {\n                              return [2 /*return*/, (0,_helpers__WEBPACK_IMPORTED_MODULE_0__.error)('changeQrcodeStatus', 'Token has expired, please login again')];\n                          }\n                          return [4 /*yield*/, (0,_helpers__WEBPACK_IMPORTED_MODULE_0__.request)({\n                                  method: 'POST',\n                                  url: this.authingOptions.host + \"/api/v3/change-qrcode-status\",\n                                  data: data,\n                                  header: {\n                                      'x-authing-userpool-id': this.authingOptions.userPoolId,\n                                      Authorization: access_token\n                                  }\n                              })];\n                      case 2: return [2 /*return*/, _b.sent()];\n                  }\n              });\n          });\n      };\n      return Core;\n  }(_Base__WEBPACK_IMPORTED_MODULE_1__.Base));\n  \n  \n  \n  /***/ }),\n  /* 2 */\n  /***/ ((__unused_webpack_module, __authing_webpack_exports__, __authing_webpack_require__) => {\n  \n  __authing_webpack_require__.r(__authing_webpack_exports__);\n  /* harmony export */ __authing_webpack_require__.d(__authing_webpack_exports__, {\n  /* harmony export */   \"StorageProvider\": () => (/* reexport safe */ _StorageProvider__WEBPACK_IMPORTED_MODULE_0__.StorageProvider),\n  /* harmony export */   \"error\": () => (/* reexport safe */ _log__WEBPACK_IMPORTED_MODULE_3__.error),\n  /* harmony export */   \"getLoginStateKey\": () => (/* reexport safe */ _utils__WEBPACK_IMPORTED_MODULE_2__.getLoginStateKey),\n  /* harmony export */   \"request\": () => (/* reexport safe */ _request__WEBPACK_IMPORTED_MODULE_1__.request)\n  /* harmony export */ });\n  /* harmony import */ var _StorageProvider__WEBPACK_IMPORTED_MODULE_0__ = __authing_webpack_require__(3);\n  /* harmony import */ var _request__WEBPACK_IMPORTED_MODULE_1__ = __authing_webpack_require__(21);\n  /* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_2__ = __authing_webpack_require__(23);\n  /* harmony import */ var _log__WEBPACK_IMPORTED_MODULE_3__ = __authing_webpack_require__(24);\n  \n  \n  \n  \n  \n  \n  /***/ }),\n  /* 3 */\n  /***/ ((__unused_webpack_module, __authing_webpack_exports__, __authing_webpack_require__) => {\n  \n  __authing_webpack_require__.r(__authing_webpack_exports__);\n  /* harmony export */ __authing_webpack_require__.d(__authing_webpack_exports__, {\n  /* harmony export */   \"StorageProvider\": () => (/* binding */ StorageProvider)\n  /* harmony export */ });\n  /* harmony import */ var _AuthingMove__WEBPACK_IMPORTED_MODULE_0__ = __authing_webpack_require__(4);\n  \n  var StorageProvider = /** @class */ (function () {\n      function StorageProvider() {\n      }\n      StorageProvider.prototype.get = function (key) {\n          return _AuthingMove__WEBPACK_IMPORTED_MODULE_0__.AuthingMove.getStorage({\n              key: key\n          });\n      };\n      StorageProvider.prototype.set = function (key, data) {\n          return _AuthingMove__WEBPACK_IMPORTED_MODULE_0__.AuthingMove.setStorage({\n              key: key,\n              data: data\n          });\n      };\n      StorageProvider.prototype.remove = function (key) {\n          return _AuthingMove__WEBPACK_IMPORTED_MODULE_0__.AuthingMove.removeStorage({\n              key: key\n          });\n      };\n      return StorageProvider;\n  }());\n  \n  \n  \n  /***/ }),\n  /* 4 */\n  /***/ ((__unused_webpack_module, __authing_webpack_exports__, __authing_webpack_require__) => {\n  \n  __authing_webpack_require__.r(__authing_webpack_exports__);\n  /* harmony export */ __authing_webpack_require__.d(__authing_webpack_exports__, {\n  /* harmony export */   \"AuthingMove\": () => (/* reexport safe */ _authing_authingmove_core__WEBPACK_IMPORTED_MODULE_0__[\"default\"])\n  /* harmony export */ });\n  /* harmony import */ var _authing_authingmove_core__WEBPACK_IMPORTED_MODULE_0__ = __authing_webpack_require__(5);\n  /* harmony import */ var _authing_authingmove_api_proxy__WEBPACK_IMPORTED_MODULE_1__ = __authing_webpack_require__(9);\n  \n  \n  _authing_authingmove_core__WEBPACK_IMPORTED_MODULE_0__[\"default\"].use(_authing_authingmove_api_proxy__WEBPACK_IMPORTED_MODULE_1__[\"default\"]);\n  \n  \n  \n  /***/ }),\n  /* 5 */\n  /***/ ((__unused_webpack_module, __authing_webpack_exports__, __authing_webpack_require__) => {\n  \n  __authing_webpack_require__.r(__authing_webpack_exports__);\n  /* harmony export */ __authing_webpack_require__.d(__authing_webpack_exports__, {\n  /* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n  /* harmony export */ });\n  /* harmony import */ var _instance__WEBPACK_IMPORTED_MODULE_0__ = __authing_webpack_require__(6);\n  /* harmony import */ var _global_api__WEBPACK_IMPORTED_MODULE_1__ = __authing_webpack_require__(7);\n  \n  \n  \n  (0,_global_api__WEBPACK_IMPORTED_MODULE_1__.initGlobalApi)(_instance__WEBPACK_IMPORTED_MODULE_0__[\"default\"])\n  \n  /* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (_instance__WEBPACK_IMPORTED_MODULE_0__[\"default\"]);\n  \n  \n  /***/ }),\n  /* 6 */\n  /***/ ((__unused_webpack_module, __authing_webpack_exports__, __authing_webpack_require__) => {\n  \n  __authing_webpack_require__.r(__authing_webpack_exports__);\n  /* harmony export */ __authing_webpack_require__.d(__authing_webpack_exports__, {\n  /* harmony export */   \"default\": () => (/* binding */ AuthingMove)\n  /* harmony export */ });\n  function AuthingMove () {}\n  \n  \n  /***/ }),\n  /* 7 */\n  /***/ ((__unused_webpack_module, __authing_webpack_exports__, __authing_webpack_require__) => {\n  \n  __authing_webpack_require__.r(__authing_webpack_exports__);\n  /* harmony export */ __authing_webpack_require__.d(__authing_webpack_exports__, {\n  /* harmony export */   \"initGlobalApi\": () => (/* binding */ initGlobalApi)\n  /* harmony export */ });\n  /* harmony import */ var _use__WEBPACK_IMPORTED_MODULE_0__ = __authing_webpack_require__(8);\n  \n  \n  function initGlobalApi (AuthingMove) {\n    (0,_use__WEBPACK_IMPORTED_MODULE_0__.initUse)(AuthingMove)\n  }\n  \n  \n  /***/ }),\n  /* 8 */\n  /***/ ((__unused_webpack_module, __authing_webpack_exports__, __authing_webpack_require__) => {\n  \n  __authing_webpack_require__.r(__authing_webpack_exports__);\n  /* harmony export */ __authing_webpack_require__.d(__authing_webpack_exports__, {\n  /* harmony export */   \"initUse\": () => (/* binding */ initUse)\n  /* harmony export */ });\n  function initUse (AuthingMove) {\n    AuthingMove.use = function use (plugin, options = {}) {\n      const installedPlugins = (this._installedPlugins || (this._installedPlugins = []))\n  \n      if (installedPlugins.indexOf(plugin) > -1) {\n        return this\n      }\n  \n      const args = [options]\n  \n      args.unshift(this)\n  \n      if (typeof plugin.install === 'function') {\n        plugin.install.apply(plugin, args)\n      } else if (typeof plugin === 'function') {\n        plugin.apply(null, args)\n      }\n  \n      installedPlugins.push(plugin)\n  \n      return this\n    }\n  }\n  \n  \n  /***/ }),\n  /* 9 */\n  /***/ ((__unused_webpack_module, __authing_webpack_exports__, __authing_webpack_require__) => {\n  \n  __authing_webpack_require__.r(__authing_webpack_exports__);\n  /* harmony export */ __authing_webpack_require__.d(__authing_webpack_exports__, {\n  /* harmony export */   \"default\": () => (/* binding */ install)\n  /* harmony export */ });\n  /* harmony import */ var _transform__WEBPACK_IMPORTED_MODULE_0__ = __authing_webpack_require__(10);\n  /* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_1__ = __authing_webpack_require__(11);\n  /* harmony import */ var _promisify__WEBPACK_IMPORTED_MODULE_2__ = __authing_webpack_require__(20);\n  \n  \n  \n  \n  function install (AuthingMove, options = {}) {\n    const {\n      custom = {} // custom transform rules\n    } = options\n    const from = \"wx\" || 0\n    const to = \"wx\" || 0\n  \n    const transformedApis = (0,_transform__WEBPACK_IMPORTED_MODULE_0__[\"default\"])({\n      from,\n      to,\n      custom\n    })\n  \n    // reserve some expansion space\n    const apis = Object.assign({}, transformedApis, (0,_promisify__WEBPACK_IMPORTED_MODULE_2__.promisify)(transformedApis))\n  \n    Object.keys(apis).forEach(api => {\n      try {\n        if (typeof apis[api] !== 'function') {\n          AuthingMove[api] = apis[api]\n          return\n        }\n  \n        AuthingMove[api] = (...args) => apis[api].apply(AuthingMove, args)\n      } catch (e) {\n        (0,_utils__WEBPACK_IMPORTED_MODULE_1__.error)(`Call ${AuthingMove}.${api} error:` + JSON.stringify(e))\n      }\n    })\n  }\n  \n  \n  /***/ }),\n  /* 10 */\n  /***/ ((__unused_webpack_module, __authing_webpack_exports__, __authing_webpack_require__) => {\n  \n  __authing_webpack_require__.r(__authing_webpack_exports__);\n  /* harmony export */ __authing_webpack_require__.d(__authing_webpack_exports__, {\n  /* harmony export */   \"default\": () => (/* binding */ transformApi)\n  /* harmony export */ });\n  /* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_0__ = __authing_webpack_require__(11);\n  /* harmony import */ var _apis__WEBPACK_IMPORTED_MODULE_1__ = __authing_webpack_require__(13);\n  \n  \n  \n  const fromMap = (0,_utils__WEBPACK_IMPORTED_MODULE_0__.generateFromMap)()\n  \n  function joinName (from = '', to = '') {\n    const _from = `__authing_move_src_mode_${from}__`\n    return `${fromMap[_from]}_${to}`\n  }\n  \n  function transformApi (options) {\n    const envContext = (0,_utils__WEBPACK_IMPORTED_MODULE_0__.getEnvContext)()\n    const needProxy = Object.create(null)\n  \n    Object.keys(_apis__WEBPACK_IMPORTED_MODULE_1__).forEach(key => {\n      needProxy[key] = envContext[key] || _apis__WEBPACK_IMPORTED_MODULE_1__[key]\n    })\n  \n    const apis = Object.create(null)\n  \n    Object.keys(needProxy).forEach(api => {\n      if (typeof needProxy[api] !== 'function') {\n        apis[api] = needProxy[api]\n        return\n      }\n  \n      apis[api] = (...args) => {\n        let from = options.from\n        const to = options.to\n  \n        if (args.length) {\n          from = args.pop()\n  \n          if (typeof from !== 'string' || !fromMap[from]) {\n            args.push(from)\n            from = options.from\n          }\n        }\n  \n        const fromTo = joinName(from, to)\n  \n        if (options.custom[fromTo] && options.custom[fromTo][api]) {\n          return options.custom[fromTo][api].apply(this, args)\n        }\n  \n        if (_apis__WEBPACK_IMPORTED_MODULE_1__[api]) {\n          return _apis__WEBPACK_IMPORTED_MODULE_1__[api].apply(this, args)\n        }\n  \n        if (envContext[api]) {\n          return envContext[api].apply(this, args)\n        }\n  \n        (0,_utils__WEBPACK_IMPORTED_MODULE_0__.error)(`\"${api}\" method does not exist in the current context`)\n      }\n    })\n  \n    return apis\n  }\n  \n  \n  /***/ }),\n  /* 11 */\n  /***/ ((__unused_webpack_module, __authing_webpack_exports__, __authing_webpack_require__) => {\n  \n  __authing_webpack_require__.r(__authing_webpack_exports__);\n  /* harmony export */ __authing_webpack_require__.d(__authing_webpack_exports__, {\n  /* harmony export */   \"adaptOptions\": () => (/* binding */ adaptOptions),\n  /* harmony export */   \"error\": () => (/* binding */ error),\n  /* harmony export */   \"generateFromMap\": () => (/* binding */ generateFromMap),\n  /* harmony export */   \"getEnvContext\": () => (/* reexport safe */ _runtime_env__WEBPACK_IMPORTED_MODULE_0__.getEnvContext),\n  /* harmony export */   \"handleSuccess\": () => (/* binding */ handleSuccess),\n  /* harmony export */   \"makeMap\": () => (/* binding */ makeMap),\n  /* harmony export */   \"noop\": () => (/* binding */ noop),\n  /* harmony export */   \"warn\": () => (/* binding */ warn)\n  /* harmony export */ });\n  /* harmony import */ var _runtime_env__WEBPACK_IMPORTED_MODULE_0__ = __authing_webpack_require__(12);\n  \n  \n  function generateFromMap () {\n    const platforms = ['wx', 'ali', 'baidu', 'qq', 'tt', 'jd', 'ks', 'qa_webview', 'qa_ux', 'Mpx', 'Taro', 'uni']\n    return platforms.reduce((map, platform) => {\n      map[`__authing_move_src_mode_${platform}__`] = platform\n      return map\n    }, {})\n  }\n  \n  function makeMap (arr) {\n    return arr.reduce((map, item) => {\n      map[item] = true\n      return map\n    }, {})\n  }\n  \n  function warn (message) {\n    console.warn && console.warn(`[AuthingMove/api-proxy warn in \"${\"wx\"}\"]:\\n ${message}`)\n  }\n  \n  function error (message) {\n    console.error && console.error(`[AuthingMove/api-proxy error in \"${\"wx\"}\"]:\\n ${message}`)\n  }\n  \n  function noop () {}\n  \n  function adaptOptions (originalOptions, matchedOptions = {}, extraOptions = {}) {\n    let options = {}\n  \n    Object.keys(originalOptions).forEach(key => {\n      const _key = matchedOptions.hasOwnProperty(key) ? matchedOptions[key] : key\n      if (_key) {\n        options[_key] = originalOptions[key]\n      }\n    })\n  \n    options = Object.assign({}, options, extraOptions)\n  \n    return options\n  }\n  \n  function handleSuccess (originalOptions, wrappedSuccess = noop, context) {\n    if (!originalOptions.success) {\n      return\n    }\n  \n    const _this = context || this\n    const cachedSuccess = originalOptions.success\n  \n    originalOptions.success = res => cachedSuccess.call(_this, wrappedSuccess(res) || res)\n  }\n  \n  \n  /***/ }),\n  /* 12 */\n  /***/ ((__unused_webpack_module, __authing_webpack_exports__, __authing_webpack_require__) => {\n  \n  __authing_webpack_require__.r(__authing_webpack_exports__);\n  /* harmony export */ __authing_webpack_require__.d(__authing_webpack_exports__, {\n  /* harmony export */   \"getEnvContext\": () => (/* binding */ getEnvContext)\n  /* harmony export */ });\n  function getEnvContext () {\n    const noopEnv = {}\n  \n    switch (\"wx\") {\n    case 'wx':\n    case 'Mpx':\n      return wx\n    case 'ali':\n      return my\n    case 'baidu':\n      return swan\n    case 'qq':\n      return qq\n    case 'tt':\n      return tt\n    case 'jd':\n      return jd\n    case 'ks':\n      return ks\n    case 'qa_webview':\n      return qa\n    case 'qa_ux':\n      return noopEnv\n    case 'Taro':\n      return Taro\n    case 'uni':\n      return uni\n    }\n  }\n  \n  \n  /***/ }),\n  /* 13 */\n  /***/ ((__unused_webpack_module, __authing_webpack_exports__, __authing_webpack_require__) => {\n  \n  __authing_webpack_require__.r(__authing_webpack_exports__);\n  /* harmony export */ __authing_webpack_require__.d(__authing_webpack_exports__, {\n  /* harmony export */   \"chooseImage\": () => (/* reexport safe */ _image_image__WEBPACK_IMPORTED_MODULE_4__.chooseImage),\n  /* harmony export */   \"clearStorage\": () => (/* reexport safe */ _storage_storage__WEBPACK_IMPORTED_MODULE_3__.clearStorage),\n  /* harmony export */   \"getStorage\": () => (/* reexport safe */ _storage_storage__WEBPACK_IMPORTED_MODULE_3__.getStorage),\n  /* harmony export */   \"login\": () => (/* reexport safe */ _login_login__WEBPACK_IMPORTED_MODULE_0__.login),\n  /* harmony export */   \"removeStorage\": () => (/* reexport safe */ _storage_storage__WEBPACK_IMPORTED_MODULE_3__.removeStorage),\n  /* harmony export */   \"request\": () => (/* reexport safe */ _request_request__WEBPACK_IMPORTED_MODULE_1__.request),\n  /* harmony export */   \"scanCode\": () => (/* reexport safe */ _scan_scan__WEBPACK_IMPORTED_MODULE_2__.scanCode),\n  /* harmony export */   \"setStorage\": () => (/* reexport safe */ _storage_storage__WEBPACK_IMPORTED_MODULE_3__.setStorage),\n  /* harmony export */   \"uploadFile\": () => (/* reexport safe */ _upload_upload__WEBPACK_IMPORTED_MODULE_5__.uploadFile)\n  /* harmony export */ });\n  /* harmony import */ var _login_login__WEBPACK_IMPORTED_MODULE_0__ = __authing_webpack_require__(14);\n  /* harmony import */ var _request_request__WEBPACK_IMPORTED_MODULE_1__ = __authing_webpack_require__(15);\n  /* harmony import */ var _scan_scan__WEBPACK_IMPORTED_MODULE_2__ = __authing_webpack_require__(16);\n  /* harmony import */ var _storage_storage__WEBPACK_IMPORTED_MODULE_3__ = __authing_webpack_require__(17);\n  /* harmony import */ var _image_image__WEBPACK_IMPORTED_MODULE_4__ = __authing_webpack_require__(18);\n  /* harmony import */ var _upload_upload__WEBPACK_IMPORTED_MODULE_5__ = __authing_webpack_require__(19);\n  \n  \n  \n  \n  \n  \n  \n  \n  /***/ }),\n  /* 14 */\n  /***/ ((__unused_webpack_module, __authing_webpack_exports__, __authing_webpack_require__) => {\n  \n  __authing_webpack_require__.r(__authing_webpack_exports__);\n  /* harmony export */ __authing_webpack_require__.d(__authing_webpack_exports__, {\n  /* harmony export */   \"login\": () => (/* binding */ login)\n  /* harmony export */ });\n  /* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_0__ = __authing_webpack_require__(11);\n  \n  \n  const envContext = (0,_utils__WEBPACK_IMPORTED_MODULE_0__.getEnvContext)()\n  \n  function login (options = {}) {\n    return envContext.login(options)\n  }\n  \n  \n  /***/ }),\n  /* 15 */\n  /***/ ((__unused_webpack_module, __authing_webpack_exports__, __authing_webpack_require__) => {\n  \n  __authing_webpack_require__.r(__authing_webpack_exports__);\n  /* harmony export */ __authing_webpack_require__.d(__authing_webpack_exports__, {\n  /* harmony export */   \"request\": () => (/* binding */ request)\n  /* harmony export */ });\n  /* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_0__ = __authing_webpack_require__(11);\n  \n  \n  const envContext = (0,_utils__WEBPACK_IMPORTED_MODULE_0__.getEnvContext)()\n  \n  function request (options = {}) {\n    return envContext.request(options)\n  }\n  \n  \n  /***/ }),\n  /* 16 */\n  /***/ ((__unused_webpack_module, __authing_webpack_exports__, __authing_webpack_require__) => {\n  \n  __authing_webpack_require__.r(__authing_webpack_exports__);\n  /* harmony export */ __authing_webpack_require__.d(__authing_webpack_exports__, {\n  /* harmony export */   \"scanCode\": () => (/* binding */ scanCode)\n  /* harmony export */ });\n  /* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_0__ = __authing_webpack_require__(11);\n  \n  \n  const envContext = (0,_utils__WEBPACK_IMPORTED_MODULE_0__.getEnvContext)()\n  \n  function scanCode (options = {}) {\n    return envContext.scanCode(options)\n  }\n  \n  \n  /***/ }),\n  /* 17 */\n  /***/ ((__unused_webpack_module, __authing_webpack_exports__, __authing_webpack_require__) => {\n  \n  __authing_webpack_require__.r(__authing_webpack_exports__);\n  /* harmony export */ __authing_webpack_require__.d(__authing_webpack_exports__, {\n  /* harmony export */   \"clearStorage\": () => (/* binding */ clearStorage),\n  /* harmony export */   \"getStorage\": () => (/* binding */ getStorage),\n  /* harmony export */   \"removeStorage\": () => (/* binding */ removeStorage),\n  /* harmony export */   \"setStorage\": () => (/* binding */ setStorage)\n  /* harmony export */ });\n  /* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_0__ = __authing_webpack_require__(11);\n  \n  \n  const envContext = (0,_utils__WEBPACK_IMPORTED_MODULE_0__.getEnvContext)()\n  \n  function setStorage (options = {}) {\n    const _options = (0,_utils__WEBPACK_IMPORTED_MODULE_0__.adaptOptions)(options, {}, {\n      encrypt: false\n    })\n    return envContext.setStorage(_options)\n  }\n  \n  function getStorage (options = {}) {\n    const _options = (0,_utils__WEBPACK_IMPORTED_MODULE_0__.adaptOptions)(options, {}, {\n      encrypt: false\n    })\n    return envContext.getStorage(_options)\n  }\n  \n  function removeStorage (options = {}) {\n    return envContext.removeStorage(options)\n  }\n  \n  function clearStorage (options = {}) {\n    return envContext.clearStorage(options)\n  }\n  \n  \n  /***/ }),\n  /* 18 */\n  /***/ ((__unused_webpack_module, __authing_webpack_exports__, __authing_webpack_require__) => {\n  \n  __authing_webpack_require__.r(__authing_webpack_exports__);\n  /* harmony export */ __authing_webpack_require__.d(__authing_webpack_exports__, {\n  /* harmony export */   \"chooseImage\": () => (/* binding */ chooseImage)\n  /* harmony export */ });\n  /* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_0__ = __authing_webpack_require__(11);\n  \n  \n  const envContext = (0,_utils__WEBPACK_IMPORTED_MODULE_0__.getEnvContext)()\n  \n  function chooseImage (options = {}) {\n    return envContext.chooseMedia(options)\n  }\n  \n  \n  /***/ }),\n  /* 19 */\n  /***/ ((__unused_webpack_module, __authing_webpack_exports__, __authing_webpack_require__) => {\n  \n  __authing_webpack_require__.r(__authing_webpack_exports__);\n  /* harmony export */ __authing_webpack_require__.d(__authing_webpack_exports__, {\n  /* harmony export */   \"uploadFile\": () => (/* binding */ uploadFile)\n  /* harmony export */ });\n  /* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_0__ = __authing_webpack_require__(11);\n  \n  \n  const envContext = (0,_utils__WEBPACK_IMPORTED_MODULE_0__.getEnvContext)()\n  \n  function uploadFile (options = {}) {\n    return envContext.uploadFile(options)\n  }\n  \n  \n  /***/ }),\n  /* 20 */\n  /***/ ((__unused_webpack_module, __authing_webpack_exports__, __authing_webpack_require__) => {\n  \n  __authing_webpack_require__.r(__authing_webpack_exports__);\n  /* harmony export */ __authing_webpack_require__.d(__authing_webpack_exports__, {\n  /* harmony export */   \"promisify\": () => (/* binding */ promisify)\n  /* harmony export */ });\n  /* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_0__ = __authing_webpack_require__(11);\n  \n  \n  const envContext = (0,_utils__WEBPACK_IMPORTED_MODULE_0__.getEnvContext)()\n  \n  function promisify (apis) {\n    const fromMap = (0,_utils__WEBPACK_IMPORTED_MODULE_0__.generateFromMap)()\n  \n    return Object.keys(apis).reduce((map, key) => {\n      if (typeof apis[key] !== 'function') {\n        return map\n      }\n  \n      map[key] = function (...args) {\n        if (promisifyFilter(key)) {\n          return apis[key].apply(apis, args)\n        }\n  \n        if (!args[0] || fromMap[args[0]]) {\n          args.unshift({\n            success: _utils__WEBPACK_IMPORTED_MODULE_0__.noop,\n            fail: _utils__WEBPACK_IMPORTED_MODULE_0__.noop\n          })\n        }\n  \n        const options = args[0]\n        let returned\n  \n        const promise = new Promise((resolve, reject) => {\n          const originalSuccess = options.success\n          const originalFail = options.fail\n  \n          options.success = function success (res) {\n            originalSuccess && originalSuccess.call(this, res)\n            resolve(res)\n          }\n  \n          options.fail = function fail (res) {\n            originalFail && originalFail.call(this, res)\n            reject(res)\n          }\n  \n          returned = apis[key].apply(envContext, args)\n        })\n  \n        promise.__returned = returned\n        return promise\n      }\n  \n      return map\n    }, {})\n  }\n  \n  function promisifyFilter (key) {\n    return /^get\\w*Manager$/.test(key) ||\n      /^create\\w*Context$/.test(key) ||\n      /^(on|off)/.test(key) ||\n      /\\w+Sync$/.test(key)\n  }\n  \n  \n  /***/ }),\n  /* 21 */\n  /***/ ((__unused_webpack_module, __authing_webpack_exports__, __authing_webpack_require__) => {\n  \n  __authing_webpack_require__.r(__authing_webpack_exports__);\n  /* harmony export */ __authing_webpack_require__.d(__authing_webpack_exports__, {\n  /* harmony export */   \"request\": () => (/* binding */ request)\n  /* harmony export */ });\n  /* harmony import */ var _AuthingMove__WEBPACK_IMPORTED_MODULE_0__ = __authing_webpack_require__(4);\n  /* harmony import */ var _package_json__WEBPACK_IMPORTED_MODULE_1__ = __authing_webpack_require__(22);\n  var __assign = (undefined && undefined.__assign) || function () {\n      __assign = Object.assign || function(t) {\n          for (var s, i = 1, n = arguments.length; i < n; i++) {\n              s = arguments[i];\n              for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                  t[p] = s[p];\n          }\n          return t;\n      };\n      return __assign.apply(this, arguments);\n  };\n  var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\n      function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n      return new (P || (P = Promise))(function (resolve, reject) {\n          function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n          function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n          function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n          step((generator = generator.apply(thisArg, _arguments || [])).next());\n      });\n  };\n  var __generator = (undefined && undefined.__generator) || function (thisArg, body) {\n      var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n      return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n      function verb(n) { return function (v) { return step([n, v]); }; }\n      function step(op) {\n          if (f) throw new TypeError(\"Generator is already executing.\");\n          while (_) try {\n              if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n              if (y = 0, t) op = [op[0] & 2, t.value];\n              switch (op[0]) {\n                  case 0: case 1: t = op; break;\n                  case 4: _.label++; return { value: op[1], done: false };\n                  case 5: _.label++; y = op[1]; op = [0]; continue;\n                  case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                  default:\n                      if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                      if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                      if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                      if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                      if (t[2]) _.ops.pop();\n                      _.trys.pop(); continue;\n              }\n              op = body.call(thisArg, _);\n          } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n          if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n      }\n  };\n  \n  \n  function request(options) {\n      return __awaiter(this, void 0, void 0, function () {\n          var _options, data, e_1;\n          return __generator(this, function (_a) {\n              switch (_a.label) {\n                  case 0:\n                      _a.trys.push([0, 2, , 3]);\n                      _options = Object.assign({}, options, {\n                          header: __assign(__assign({}, options.header), { 'x-authing-request-from': 'miniprogram-sdk', 'x-authing-client-version': _package_json__WEBPACK_IMPORTED_MODULE_1__.version })\n                      });\n                      return [4 /*yield*/, _AuthingMove__WEBPACK_IMPORTED_MODULE_0__.AuthingMove.request(_options)\n                          // 例如 /oidc/token 直接返回 data，没有 data.data\n                      ];\n                  case 1:\n                      data = (_a.sent()).data;\n                      // 例如 /oidc/token 直接返回 data，没有 data.data\n                      return [2 /*return*/, data.data || data];\n                  case 2:\n                      e_1 = _a.sent();\n                      console.error('认证服务器返回错误: ', e_1);\n                      return [3 /*break*/, 3];\n                  case 3: return [2 /*return*/];\n              }\n          });\n      });\n  }\n  \n  \n  /***/ }),\n  /* 22 */\n  /***/ ((module) => {\n  \n  module.exports = JSON.parse('{\"name\":\"@authing/miniprogram\",\"version\":\"5.0.0-alpha.16\",\"description\":\"Authing miniprogram sdk source code\",\"main\":\"src/index.ts\",\"module\":\"src/index.ts\",\"scripts\":{\"autoinstall\":\"npm ci\",\"dev\":\"node ./scripts/build.js watch\",\"build\":\"node ./scripts/build.js\",\"release:official\":\"npm publish --verbose --access public\",\"release:alpha\":\"npm publish --verbose --tag=alpha --access public\"},\"dependencies\":{\"@authing/authingmove-api-proxy\":\"^1.0.1-alpha.3\",\"@authing/authingmove-core\":\"^1.0.1-alpha.3\"},\"devDependencies\":{\"@authing/authingmove-webpack-plugin\":\"^1.0.1-alpha.3\"},\"repository\":{\"type\":\"git\",\"url\":\"git+https://github.com/Authing/authing-js-sdk.git\"},\"author\":\"https://github.com/authing\",\"license\":\"MIT\",\"bugs\":{\"url\":\"https://github.com/Authing/authing-js-sdk/issues\"},\"homepage\":\"https://github.com/Authing/authing-js-sdk#readme\",\"publishConfig\":{\"access\":\"public\",\"registry\":\"https://registry.npmjs.org\"}}');\n  \n  /***/ }),\n  /* 23 */\n  /***/ ((__unused_webpack_module, __authing_webpack_exports__, __authing_webpack_require__) => {\n  \n  __authing_webpack_require__.r(__authing_webpack_exports__);\n  /* harmony export */ __authing_webpack_require__.d(__authing_webpack_exports__, {\n  /* harmony export */   \"getLoginStateKey\": () => (/* binding */ getLoginStateKey)\n  /* harmony export */ });\n  function getLoginStateKey(appId) {\n      return ['authing', appId, 'login-state'].join(':');\n  }\n  \n  \n  /***/ }),\n  /* 24 */\n  /***/ ((__unused_webpack_module, __authing_webpack_exports__, __authing_webpack_require__) => {\n  \n  __authing_webpack_require__.r(__authing_webpack_exports__);\n  /* harmony export */ __authing_webpack_require__.d(__authing_webpack_exports__, {\n  /* harmony export */   \"error\": () => (/* binding */ error)\n  /* harmony export */ });\n  function error(errorFunction, errorContent) {\n      console.error(\"Authing miniprogram sdk error in \\\"\" + errorFunction + \"\\\": \", errorContent);\n  }\n  \n  \n  /***/ }),\n  /* 25 */\n  /***/ ((__unused_webpack_module, __authing_webpack_exports__, __authing_webpack_require__) => {\n  \n  __authing_webpack_require__.r(__authing_webpack_exports__);\n  /* harmony export */ __authing_webpack_require__.d(__authing_webpack_exports__, {\n  /* harmony export */   \"Base\": () => (/* binding */ Base)\n  /* harmony export */ });\n  /* harmony import */ var _helpers__WEBPACK_IMPORTED_MODULE_0__ = __authing_webpack_require__(2);\n  var __assign = (undefined && undefined.__assign) || function () {\n      __assign = Object.assign || function(t) {\n          for (var s, i = 1, n = arguments.length; i < n; i++) {\n              s = arguments[i];\n              for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                  t[p] = s[p];\n          }\n          return t;\n      };\n      return __assign.apply(this, arguments);\n  };\n  var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\n      function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n      return new (P || (P = Promise))(function (resolve, reject) {\n          function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n          function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n          function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n          step((generator = generator.apply(thisArg, _arguments || [])).next());\n      });\n  };\n  var __generator = (undefined && undefined.__generator) || function (thisArg, body) {\n      var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n      return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n      function verb(n) { return function (v) { return step([n, v]); }; }\n      function step(op) {\n          if (f) throw new TypeError(\"Generator is already executing.\");\n          while (_) try {\n              if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n              if (y = 0, t) op = [op[0] & 2, t.value];\n              switch (op[0]) {\n                  case 0: case 1: t = op; break;\n                  case 4: _.label++; return { value: op[1], done: false };\n                  case 5: _.label++; y = op[1]; op = [0]; continue;\n                  case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                  default:\n                      if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                      if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                      if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                      if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                      if (t[2]) _.ops.pop();\n                      _.trys.pop(); continue;\n              }\n              op = body.call(thisArg, _);\n          } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n          if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n      }\n  };\n  \n  var Base = /** @class */ (function () {\n      function Base(options) {\n          this.authingOptions = options.authingOptions;\n          this.storage = options.storage;\n          this.encryptFunction = options.encryptFunction;\n      }\n      Base.prototype.getLoginState = function () {\n          return __awaiter(this, void 0, void 0, function () {\n              var res;\n              return __generator(this, function (_a) {\n                  switch (_a.label) {\n                      case 0: return [4 /*yield*/, this.storage.get((0,_helpers__WEBPACK_IMPORTED_MODULE_0__.getLoginStateKey)(this.authingOptions.appId))];\n                      case 1:\n                          res = _a.sent();\n                          return [2 /*return*/, res.data];\n                  }\n              });\n          });\n      };\n      Base.prototype.clearLoginState = function () {\n          return __awaiter(this, void 0, void 0, function () {\n              return __generator(this, function (_a) {\n                  switch (_a.label) {\n                      case 0: return [4 /*yield*/, this.storage.remove((0,_helpers__WEBPACK_IMPORTED_MODULE_0__.getLoginStateKey)(this.authingOptions.appId))];\n                      case 1: return [2 /*return*/, _a.sent()];\n                  }\n              });\n          });\n      };\n      Base.prototype.saveLoginState = function (loginState) {\n          return __awaiter(this, void 0, void 0, function () {\n              var _loginState;\n              return __generator(this, function (_a) {\n                  switch (_a.label) {\n                      case 0:\n                          _loginState = __assign(__assign({}, loginState), { expires_at: loginState.expires_in * 1000 + Date.now() });\n                          return [4 /*yield*/, this.storage.set((0,_helpers__WEBPACK_IMPORTED_MODULE_0__.getLoginStateKey)(this.authingOptions.appId), _loginState)];\n                      case 1:\n                          _a.sent();\n                          return [2 /*return*/, _loginState];\n                  }\n              });\n          });\n      };\n      Base.prototype.getPublicKey = function (encryptType) {\n          return __awaiter(this, void 0, void 0, function () {\n              var res;\n              return __generator(this, function (_a) {\n                  switch (_a.label) {\n                      case 0: return [4 /*yield*/, (0,_helpers__WEBPACK_IMPORTED_MODULE_0__.request)({\n                              method: 'GET',\n                              url: this.authingOptions.host + \"/api/v3/system\"\n                          })];\n                      case 1:\n                          res = _a.sent();\n                          return [2 /*return*/, res[encryptType].publicKey];\n                  }\n              });\n          });\n      };\n      return Base;\n  }());\n  \n  \n  \n  /***/ }),\n  /* 26 */\n  /***/ ((__unused_webpack_module, __authing_webpack_exports__, __authing_webpack_require__) => {\n  \n  __authing_webpack_require__.r(__authing_webpack_exports__);\n  /* harmony export */ __authing_webpack_require__.d(__authing_webpack_exports__, {\n  /* harmony export */   \"User\": () => (/* binding */ User)\n  /* harmony export */ });\n  /* harmony import */ var _AuthingMove__WEBPACK_IMPORTED_MODULE_0__ = __authing_webpack_require__(4);\n  /* harmony import */ var _helpers__WEBPACK_IMPORTED_MODULE_1__ = __authing_webpack_require__(2);\n  /* harmony import */ var _Base__WEBPACK_IMPORTED_MODULE_2__ = __authing_webpack_require__(25);\n  var __extends = (undefined && undefined.__extends) || (function () {\n      var extendStatics = function (d, b) {\n          extendStatics = Object.setPrototypeOf ||\n              ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n              function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n          return extendStatics(d, b);\n      };\n      return function (d, b) {\n          if (typeof b !== \"function\" && b !== null)\n              throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n          extendStatics(d, b);\n          function __() { this.constructor = d; }\n          d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n      };\n  })();\n  var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\n      function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n      return new (P || (P = Promise))(function (resolve, reject) {\n          function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n          function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n          function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n          step((generator = generator.apply(thisArg, _arguments || [])).next());\n      });\n  };\n  var __generator = (undefined && undefined.__generator) || function (thisArg, body) {\n      var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n      return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n      function verb(n) { return function (v) { return step([n, v]); }; }\n      function step(op) {\n          if (f) throw new TypeError(\"Generator is already executing.\");\n          while (_) try {\n              if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n              if (y = 0, t) op = [op[0] & 2, t.value];\n              switch (op[0]) {\n                  case 0: case 1: t = op; break;\n                  case 4: _.label++; return { value: op[1], done: false };\n                  case 5: _.label++; y = op[1]; op = [0]; continue;\n                  case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                  default:\n                      if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                      if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                      if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                      if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                      if (t[2]) _.ops.pop();\n                      _.trys.pop(); continue;\n              }\n              op = body.call(thisArg, _);\n          } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n          if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n      }\n  };\n  \n  \n  \n  var User = /** @class */ (function (_super) {\n      __extends(User, _super);\n      function User(options) {\n          return _super.call(this, options) || this;\n      }\n      User.prototype.updatePassword = function (data) {\n          return __awaiter(this, void 0, void 0, function () {\n              var _a, access_token, expires_at, publicKey;\n              return __generator(this, function (_b) {\n                  switch (_b.label) {\n                      case 0: return [4 /*yield*/, this.getLoginState()];\n                      case 1:\n                          _a = _b.sent(), access_token = _a.access_token, expires_at = _a.expires_at;\n                          if (expires_at < Date.now()) {\n                              return [2 /*return*/, (0,_helpers__WEBPACK_IMPORTED_MODULE_1__.error)('changeQrcodeStatus', 'Token has expired, please login again')];\n                          }\n                          if (!(data.passwordEncryptType && data.passwordEncryptType !== 'none')) return [3 /*break*/, 3];\n                          if (!this.encryptFunction) {\n                              return [2 /*return*/, (0,_helpers__WEBPACK_IMPORTED_MODULE_1__.error)('updatePassword', 'encryptFunction is requiered, if passwordEncryptType is not \"none\"')];\n                          }\n                          return [4 /*yield*/, this.getPublicKey(data.passwordEncryptType)];\n                      case 2:\n                          publicKey = _b.sent();\n                          data.newPassword = this.encryptFunction(data.newPassword, publicKey);\n                          _b.label = 3;\n                      case 3: return [4 /*yield*/, (0,_helpers__WEBPACK_IMPORTED_MODULE_1__.request)({\n                              method: 'POST',\n                              url: this.authingOptions.host + \"/api/v3/update-password\",\n                              data: data,\n                              header: {\n                                  'x-authing-userpool-id': this.authingOptions.userPoolId,\n                                  Authorization: access_token\n                              }\n                          })];\n                      case 4: return [2 /*return*/, _b.sent()];\n                  }\n              });\n          });\n      };\n      User.prototype.getUserInfo = function () {\n          return __awaiter(this, void 0, void 0, function () {\n              var _a, access_token, expires_at;\n              return __generator(this, function (_b) {\n                  switch (_b.label) {\n                      case 0: return [4 /*yield*/, this.getLoginState()];\n                      case 1:\n                          _a = _b.sent(), access_token = _a.access_token, expires_at = _a.expires_at;\n                          if (expires_at < Date.now()) {\n                              return [2 /*return*/, (0,_helpers__WEBPACK_IMPORTED_MODULE_1__.error)('getUserInfo', 'Token has expired, please login again')];\n                          }\n                          return [4 /*yield*/, (0,_helpers__WEBPACK_IMPORTED_MODULE_1__.request)({\n                                  method: 'GET',\n                                  url: this.authingOptions.host + \"/api/v3/get-profile\",\n                                  header: {\n                                      'x-authing-userpool-id': this.authingOptions.userPoolId,\n                                      Authorization: access_token\n                                  }\n                              })];\n                      case 2: return [2 /*return*/, _b.sent()];\n                  }\n              });\n          });\n      };\n      User.prototype.updateAvatar = function () {\n          return __awaiter(this, void 0, void 0, function () {\n              var res, uploaded, e_1;\n              return __generator(this, function (_a) {\n                  switch (_a.label) {\n                      case 0:\n                          _a.trys.push([0, 3, , 4]);\n                          return [4 /*yield*/, _AuthingMove__WEBPACK_IMPORTED_MODULE_0__.AuthingMove.chooseImage({\n                                  count: 1,\n                                  sourceType: ['album', 'camera'],\n                                  sizeType: ['original']\n                              })];\n                      case 1:\n                          res = _a.sent();\n                          return [4 /*yield*/, _AuthingMove__WEBPACK_IMPORTED_MODULE_0__.AuthingMove.uploadFile({\n                                  url: this.authingOptions.host + \"/api/v2/upload?folder=avatar\",\n                                  name: 'file',\n                                  filePath: res.tempFiles[0].tempFilePath\n                              })];\n                      case 2:\n                          uploaded = _a.sent();\n                          return [2 /*return*/, JSON.parse(uploaded.data)];\n                      case 3:\n                          e_1 = _a.sent();\n                          (0,_helpers__WEBPACK_IMPORTED_MODULE_1__.error)('updateAvatar', e_1);\n                          return [3 /*break*/, 4];\n                      case 4: return [2 /*return*/];\n                  }\n              });\n          });\n      };\n      User.prototype.updateUserInfo = function (data) {\n          return __awaiter(this, void 0, void 0, function () {\n              var _a, access_token, expires_at;\n              return __generator(this, function (_b) {\n                  switch (_b.label) {\n                      case 0: return [4 /*yield*/, this.getLoginState()];\n                      case 1:\n                          _a = _b.sent(), access_token = _a.access_token, expires_at = _a.expires_at;\n                          if (expires_at < Date.now()) {\n                              return [2 /*return*/, (0,_helpers__WEBPACK_IMPORTED_MODULE_1__.error)('changeQrcodeStatus', 'Token has expired, please login again')];\n                          }\n                          return [4 /*yield*/, (0,_helpers__WEBPACK_IMPORTED_MODULE_1__.request)({\n                                  method: 'POST',\n                                  url: this.authingOptions.host + \"/api/v3/update-profile\",\n                                  data: data,\n                                  header: {\n                                      'x-authing-userpool-id': this.authingOptions.userPoolId,\n                                      Authorization: access_token\n                                  }\n                              })];\n                      case 2: return [2 /*return*/, _b.sent()];\n                  }\n              });\n          });\n      };\n      User.prototype.getPhone = function (data) {\n          return __awaiter(this, void 0, void 0, function () {\n              var phone_info;\n              return __generator(this, function (_a) {\n                  switch (_a.label) {\n                      case 0: return [4 /*yield*/, (0,_helpers__WEBPACK_IMPORTED_MODULE_1__.request)({\n                              method: 'POST',\n                              url: this.authingOptions.host + \"/api/v3/get-wechat-miniprogram-phone\",\n                              data: data,\n                              header: {\n                                  'x-authing-userpool-id': this.authingOptions.userPoolId\n                              }\n                          })];\n                      case 1:\n                          phone_info = (_a.sent()).phone_info;\n                          return [2 /*return*/, phone_info];\n                  }\n              });\n          });\n      };\n      return User;\n  }(_Base__WEBPACK_IMPORTED_MODULE_2__.Base));\n  \n  \n  \n  /***/ })\n  /******/ ]);\n  /************************************************************************/\n  /******/ // The module cache\n  /******/ var __webpack_module_cache__ = {};\n  /******/ \n  /******/ // The require function\n  /******/ function __authing_webpack_require__(moduleId) {\n  /******/ \t// Check if module is in cache\n  /******/ \tvar cachedModule = __webpack_module_cache__[moduleId];\n  /******/ \tif (cachedModule !== undefined) {\n  /******/ \t\treturn cachedModule.exports;\n  /******/ \t}\n  /******/ \t// Create a new module (and put it into the cache)\n  /******/ \tvar module = __webpack_module_cache__[moduleId] = {\n  /******/ \t\t// no module.id needed\n  /******/ \t\t// no module.loaded needed\n  /******/ \t\texports: {}\n  /******/ \t};\n  /******/ \n  /******/ \t// Execute the module function\n  /******/ \t__webpack_modules__[moduleId](module, module.exports, __authing_webpack_require__);\n  /******/ \n  /******/ \t// Return the exports of the module\n  /******/ \treturn module.exports;\n  /******/ }\n  /******/ \n  /************************************************************************/\n  /******/ /* webpack/runtime/define property getters */\n  /******/ (() => {\n  /******/ \t// define getter functions for harmony exports\n  /******/ \t__authing_webpack_require__.d = (exports, definition) => {\n  /******/ \t\tfor(var key in definition) {\n  /******/ \t\t\tif(__authing_webpack_require__.o(definition, key) && !__authing_webpack_require__.o(exports, key)) {\n  /******/ \t\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n  /******/ \t\t\t}\n  /******/ \t\t}\n  /******/ \t};\n  /******/ })();\n  /******/ \n  /******/ /* webpack/runtime/hasOwnProperty shorthand */\n  /******/ (() => {\n  /******/ \t__authing_webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))\n  /******/ })();\n  /******/ \n  /******/ /* webpack/runtime/make namespace object */\n  /******/ (() => {\n  /******/ \t// define __esModule on exports\n  /******/ \t__authing_webpack_require__.r = (exports) => {\n  /******/ \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n  /******/ \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n  /******/ \t\t}\n  /******/ \t\tObject.defineProperty(exports, '__esModule', { value: true });\n  /******/ \t};\n  /******/ })();\n  /******/ \n  /************************************************************************/\n  var __authing_webpack_exports__ = {};\n  // This entry need to be wrapped in an IIFE because it need to be isolated against other modules in the chunk.\n  (() => {\n  __authing_webpack_require__.r(__authing_webpack_exports__);\n  /* harmony export */ __authing_webpack_require__.d(__authing_webpack_exports__, {\n  /* harmony export */   \"Authing\": () => (/* binding */ Authing)\n  /* harmony export */ });\n  /* harmony import */ var _modules_Core__WEBPACK_IMPORTED_MODULE_0__ = __authing_webpack_require__(1);\n  /* harmony import */ var _modules_User__WEBPACK_IMPORTED_MODULE_1__ = __authing_webpack_require__(26);\n  /* harmony import */ var _helpers__WEBPACK_IMPORTED_MODULE_2__ = __authing_webpack_require__(2);\n  /* harmony import */ var _authing_authingmove_core__WEBPACK_IMPORTED_MODULE_3__ = __authing_webpack_require__(5);\n  var __assign = (undefined && undefined.__assign) || function () {\n      __assign = Object.assign || function(t) {\n          for (var s, i = 1, n = arguments.length; i < n; i++) {\n              s = arguments[i];\n              for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                  t[p] = s[p];\n          }\n          return t;\n      };\n      return __assign.apply(this, arguments);\n  };\n  \n  \n  \n  \n  var Authing = /** @class */ (function () {\n      function Authing(options) {\n          var _options = __assign(__assign({}, options), { host: options.host || 'https://core.authing.cn' });\n          var storage = new _helpers__WEBPACK_IMPORTED_MODULE_2__.StorageProvider();\n          var encryptFunction = options.encryptFunction;\n          this.core = new _modules_Core__WEBPACK_IMPORTED_MODULE_0__.Core({\n              authingOptions: _options,\n              storage: storage,\n              encryptFunction: encryptFunction\n          });\n          this.user = new _modules_User__WEBPACK_IMPORTED_MODULE_1__.User({\n              authingOptions: _options,\n              storage: storage,\n              encryptFunction: encryptFunction\n          });\n      }\n      return Authing;\n  }());\n  \n  \n  })();\n  \n  var __authing_webpack_exports__Authing = __authing_webpack_exports__.Authing;\n  if (!exports.__esModule) Object.defineProperty(exports, \"__esModule\", { value: true });Object.defineProperty(exports, 'Authing', { enumerable: true, configurable: true, get: function() { return __authing_webpack_exports__Authing; } });\n  "]}