{"version":3,"sources":["bundle-wx.js"],"names":[],"mappings":";;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.js","sourcesContent":["/******/ var __webpack_modules__ = ([\n/* 0 */,\n/* 1 */\n/***/ ((__unused_webpack_module, __authing_webpack_exports__, __authing_webpack_require__) => {\n\n__authing_webpack_require__.r(__authing_webpack_exports__);\n/* harmony export */ __authing_webpack_require__.d(__authing_webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _instance__WEBPACK_IMPORTED_MODULE_0__ = __authing_webpack_require__(2);\n/* harmony import */ var _global_api__WEBPACK_IMPORTED_MODULE_1__ = __authing_webpack_require__(3);\n\n\n\n(0,_global_api__WEBPACK_IMPORTED_MODULE_1__.initGlobalApi)(_instance__WEBPACK_IMPORTED_MODULE_0__[\"default\"])\n\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (_instance__WEBPACK_IMPORTED_MODULE_0__[\"default\"]);\n\n\n/***/ }),\n/* 2 */\n/***/ ((__unused_webpack_module, __authing_webpack_exports__, __authing_webpack_require__) => {\n\n__authing_webpack_require__.r(__authing_webpack_exports__);\n/* harmony export */ __authing_webpack_require__.d(__authing_webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ AuthingMove)\n/* harmony export */ });\nfunction AuthingMove () {}\n\n\n/***/ }),\n/* 3 */\n/***/ ((__unused_webpack_module, __authing_webpack_exports__, __authing_webpack_require__) => {\n\n__authing_webpack_require__.r(__authing_webpack_exports__);\n/* harmony export */ __authing_webpack_require__.d(__authing_webpack_exports__, {\n/* harmony export */   \"initGlobalApi\": () => (/* binding */ initGlobalApi)\n/* harmony export */ });\n/* harmony import */ var _use__WEBPACK_IMPORTED_MODULE_0__ = __authing_webpack_require__(4);\n\n\nfunction initGlobalApi (AuthingMove) {\n  (0,_use__WEBPACK_IMPORTED_MODULE_0__.initUse)(AuthingMove)\n}\n\n\n/***/ }),\n/* 4 */\n/***/ ((__unused_webpack_module, __authing_webpack_exports__, __authing_webpack_require__) => {\n\n__authing_webpack_require__.r(__authing_webpack_exports__);\n/* harmony export */ __authing_webpack_require__.d(__authing_webpack_exports__, {\n/* harmony export */   \"initUse\": () => (/* binding */ initUse)\n/* harmony export */ });\nfunction initUse (AuthingMove) {\n  AuthingMove.use = function use (plugin, options = {}) {\n    const installedPlugins = (this._installedPlugins || (this._installedPlugins = []))\n\n    if (installedPlugins.indexOf(plugin) > -1) {\n      return this\n    }\n\n    const args = [options]\n\n    args.unshift(this)\n\n    if (typeof plugin.install === 'function') {\n      plugin.install.apply(plugin, args)\n    } else if (typeof plugin === 'function') {\n      plugin.apply(null, args)\n    }\n\n    installedPlugins.push(plugin)\n\n    return this\n  }\n}\n\n\n/***/ }),\n/* 5 */\n/***/ ((__unused_webpack_module, __authing_webpack_exports__, __authing_webpack_require__) => {\n\n__authing_webpack_require__.r(__authing_webpack_exports__);\n/* harmony export */ __authing_webpack_require__.d(__authing_webpack_exports__, {\n/* harmony export */   \"Authing\": () => (/* binding */ Authing)\n/* harmony export */ });\n/* harmony import */ var _helpers_return__WEBPACK_IMPORTED_MODULE_0__ = __authing_webpack_require__(6);\n/* harmony import */ var _helpers__WEBPACK_IMPORTED_MODULE_1__ = __authing_webpack_require__(7);\n/* harmony import */ var _AuthingMove__WEBPACK_IMPORTED_MODULE_2__ = __authing_webpack_require__(9);\nvar __assign = (undefined && undefined.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (undefined && undefined.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nvar __read = (undefined && undefined.__read) || function (o, n) {\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n    if (!m) return o;\n    var i = m.call(o), r, ar = [], e;\n    try {\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n    }\n    catch (error) { e = { error: error }; }\n    finally {\n        try {\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\n        }\n        finally { if (e) throw e.error; }\n    }\n    return ar;\n};\n\n\n\nvar Authing = /** @class */ (function () {\n    function Authing(options) {\n        this.options = __assign(__assign({}, options), { host: options.host || 'https://core.authing.cn' });\n        this.storage = new _helpers__WEBPACK_IMPORTED_MODULE_1__.StorageProvider();\n        this.encryptFunction = options.encryptFunction;\n        this.resetWxLoginCode();\n    }\n    Authing.prototype.getLoginState = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var res, loginState, e_1;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        _a.trys.push([0, 2, , 3]);\n                        return [4 /*yield*/, this.storage.get((0,_helpers__WEBPACK_IMPORTED_MODULE_1__.getLoginStateKey)(this.options.appId))];\n                    case 1:\n                        res = _a.sent();\n                        loginState = res.data;\n                        if (loginState.expires_at > Date.now()) {\n                            return [2 /*return*/, (0,_helpers_return__WEBPACK_IMPORTED_MODULE_0__.returnSuccess)(loginState)];\n                        }\n                        return [2 /*return*/, (0,_helpers_return__WEBPACK_IMPORTED_MODULE_0__.returnError)({\n                                message: 'login state has expired, please login again'\n                            })];\n                    case 2:\n                        e_1 = _a.sent();\n                        return [2 /*return*/, (0,_helpers_return__WEBPACK_IMPORTED_MODULE_0__.returnError)({\n                                message: JSON.stringify(e_1)\n                            })];\n                    case 3: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    Authing.prototype.clearLoginState = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var e_2;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        _a.trys.push([0, 2, , 3]);\n                        return [4 /*yield*/, this.storage.remove((0,_helpers__WEBPACK_IMPORTED_MODULE_1__.getLoginStateKey)(this.options.appId))];\n                    case 1:\n                        _a.sent();\n                        return [2 /*return*/, (0,_helpers_return__WEBPACK_IMPORTED_MODULE_0__.returnSuccess)(true)];\n                    case 2:\n                        e_2 = _a.sent();\n                        return [2 /*return*/, (0,_helpers_return__WEBPACK_IMPORTED_MODULE_0__.returnError)({\n                                message: JSON.stringify(e_2)\n                            })];\n                    case 3: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    Authing.prototype.saveLoginState = function (loginState) {\n        return __awaiter(this, void 0, void 0, function () {\n            var _loginState;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        _loginState = __assign(__assign({}, loginState), { expires_at: loginState.expires_in * 1000 + Date.now() - 3600 * 1000 * 2 });\n                        return [4 /*yield*/, this.storage.set((0,_helpers__WEBPACK_IMPORTED_MODULE_1__.getLoginStateKey)(this.options.appId), _loginState)];\n                    case 1:\n                        _a.sent();\n                        return [2 /*return*/, _loginState];\n                }\n            });\n        });\n    };\n    Authing.prototype.getPublicKey = function (encryptType) {\n        return __awaiter(this, void 0, void 0, function () {\n            var _a, error, res, e_3;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        _b.trys.push([0, 2, , 3]);\n                        return [4 /*yield*/, (0,_helpers__WEBPACK_IMPORTED_MODULE_1__.request)({\n                                method: 'GET',\n                                url: this.options.host + \"/api/v3/system\"\n                            })];\n                    case 1:\n                        _a = __read.apply(void 0, [_b.sent(), 2]), error = _a[0], res = _a[1];\n                        if (error) {\n                            return [2 /*return*/, (0,_helpers_return__WEBPACK_IMPORTED_MODULE_0__.returnError)(error)];\n                        }\n                        return [2 /*return*/, (0,_helpers_return__WEBPACK_IMPORTED_MODULE_0__.returnSuccess)(res[encryptType].publicKey)];\n                    case 2:\n                        e_3 = _b.sent();\n                        return [2 /*return*/, (0,_helpers_return__WEBPACK_IMPORTED_MODULE_0__.returnError)({\n                                message: 'get public key error: ' + JSON.stringify(e_3)\n                            })];\n                    case 3: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    Authing.prototype.getCachedWxLoginCode = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var res, e_4;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        _a.trys.push([0, 2, , 3]);\n                        return [4 /*yield*/, this.storage.get((0,_helpers__WEBPACK_IMPORTED_MODULE_1__.getWxLoginCodeKey)(this.options.appId))];\n                    case 1:\n                        res = _a.sent();\n                        return [2 /*return*/, res.data];\n                    case 2:\n                        e_4 = _a.sent();\n                        return [2 /*return*/, ''];\n                    case 3: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    Authing.prototype.cacheWxLoginCode = function (code) {\n        return __awaiter(this, void 0, void 0, function () {\n            var e_5;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        _a.trys.push([0, 2, , 3]);\n                        return [4 /*yield*/, this.storage.set((0,_helpers__WEBPACK_IMPORTED_MODULE_1__.getWxLoginCodeKey)(this.options.appId), code)];\n                    case 1:\n                        _a.sent();\n                        return [2 /*return*/, code];\n                    case 2:\n                        e_5 = _a.sent();\n                        return [2 /*return*/, ''];\n                    case 3: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    Authing.prototype.resetWxLoginCode = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var next, code, e_6;\n            var _this = this;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        next = function () { return __awaiter(_this, void 0, void 0, function () {\n                            var wxLoginRes, e_7;\n                            return __generator(this, function (_a) {\n                                switch (_a.label) {\n                                    case 0:\n                                        _a.trys.push([0, 3, , 4]);\n                                        return [4 /*yield*/, _AuthingMove__WEBPACK_IMPORTED_MODULE_2__.AuthingMove.login()];\n                                    case 1:\n                                        wxLoginRes = _a.sent();\n                                        return [4 /*yield*/, this.cacheWxLoginCode(wxLoginRes.code)];\n                                    case 2:\n                                        _a.sent();\n                                        return [2 /*return*/, true];\n                                    case 3:\n                                        e_7 = _a.sent();\n                                        return [2 /*return*/, false];\n                                    case 4: return [2 /*return*/];\n                                }\n                            });\n                        }); };\n                        _a.label = 1;\n                    case 1:\n                        _a.trys.push([1, 6, 8, 10]);\n                        return [4 /*yield*/, _AuthingMove__WEBPACK_IMPORTED_MODULE_2__.AuthingMove.checkSession()];\n                    case 2:\n                        _a.sent();\n                        return [4 /*yield*/, this.getCachedWxLoginCode()];\n                    case 3:\n                        code = _a.sent();\n                        if (!!code) return [3 /*break*/, 5];\n                        return [4 /*yield*/, next()];\n                    case 4:\n                        _a.sent();\n                        _a.label = 5;\n                    case 5: return [3 /*break*/, 10];\n                    case 6:\n                        e_6 = _a.sent();\n                        this.storage.remove((0,_helpers__WEBPACK_IMPORTED_MODULE_1__.getWxLoginCodeKey)(this.options.appId));\n                        return [4 /*yield*/, next()];\n                    case 7:\n                        _a.sent();\n                        return [3 /*break*/, 10];\n                    case 8: return [4 /*yield*/, this.getCachedWxLoginCode()];\n                    case 9: return [2 /*return*/, _a.sent()];\n                    case 10: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    Authing.prototype.loginByCode = function (data) {\n        return __awaiter(this, void 0, void 0, function () {\n            var _a, loginState, extIdpConnidentifier, connection, wechatMiniProgramCodePayload, options, code, _data;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0: return [4 /*yield*/, this.getLoginState()];\n                    case 1:\n                        _a = __read.apply(void 0, [_b.sent(), 2]), loginState = _a[1];\n                        if (loginState && loginState.expires_at > Date.now()) {\n                            return [2 /*return*/, (0,_helpers_return__WEBPACK_IMPORTED_MODULE_0__.returnSuccess)(loginState)];\n                        }\n                        extIdpConnidentifier = data.extIdpConnidentifier, connection = data.connection, wechatMiniProgramCodePayload = data.wechatMiniProgramCodePayload, options = data.options;\n                        return [4 /*yield*/, this.resetWxLoginCode()];\n                    case 2:\n                        code = _b.sent();\n                        if (!code) {\n                            return [2 /*return*/, (0,_helpers_return__WEBPACK_IMPORTED_MODULE_0__.returnError)({\n                                    message: 'get wx login code error'\n                                })];\n                        }\n                        _data = {\n                            connection: connection || 'wechat_mini_program_code',\n                            extIdpConnidentifier: extIdpConnidentifier,\n                            wechatMiniProgramCodePayload: __assign(__assign({}, wechatMiniProgramCodePayload), { code: code }),\n                            options: options\n                        };\n                        return [4 /*yield*/, this.login(_data, 'code')];\n                    case 3: return [2 /*return*/, _b.sent()];\n                }\n            });\n        });\n    };\n    // async loginByPhone(\n    //   data: LoginByPhoneOptions\n    // ): Promise<Maybe<LoginState>> {\n    //   const loginState = await this.getLoginState()\n    //   if (loginState && loginState.expires_at > Date.now()) {\n    //     return loginState\n    //   }\n    //   const { extIdpConnidentifier, connection, wechatMiniProgramPhonePayload, options } = data\n    //   const code  = await this.resetWxLoginCode()\n    //   if (!code) {\n    //     error('loginByPhone', 'get wx login code error')\n    //     return null\n    //   }\n    //   const _data: WxPhoneLoginOptions = {\n    //     connection: connection || 'wechat_mini_program_phone',\n    //     extIdpConnidentifier,\n    //     wechatMiniProgramPhonePayload: {\n    //       ...wechatMiniProgramPhonePayload,\n    //       code\n    //     },\n    //     options\n    //   }\n    //   return await this.login(_data, 'phone')\n    // }\n    Authing.prototype.loginByPassword = function (data) {\n        var _a, _b, _c;\n        return __awaiter(this, void 0, void 0, function () {\n            var _d, error, publicKey, _data;\n            return __generator(this, function (_e) {\n                switch (_e.label) {\n                    case 0:\n                        if (!(((_a = data.options) === null || _a === void 0 ? void 0 : _a.passwordEncryptType) &&\n                            ((_b = data.options) === null || _b === void 0 ? void 0 : _b.passwordEncryptType) !== 'none')) return [3 /*break*/, 2];\n                        if (!this.encryptFunction) {\n                            return [2 /*return*/, (0,_helpers_return__WEBPACK_IMPORTED_MODULE_0__.returnError)({\n                                    message: 'encryptFunction is required, if passwordEncryptType is not \"none\"'\n                                })];\n                        }\n                        return [4 /*yield*/, this.getPublicKey((_c = data.options) === null || _c === void 0 ? void 0 : _c.passwordEncryptType)];\n                    case 1:\n                        _d = __read.apply(void 0, [_e.sent(), 2]), error = _d[0], publicKey = _d[1];\n                        if (error) {\n                            return [2 /*return*/, (0,_helpers_return__WEBPACK_IMPORTED_MODULE_0__.returnError)(error)];\n                        }\n                        data.passwordPayload.password = this.encryptFunction(data.passwordPayload.password, publicKey);\n                        _e.label = 2;\n                    case 2:\n                        _data = __assign(__assign({}, data), { connection: 'PASSWORD' });\n                        return [4 /*yield*/, this.login(_data, 'password')];\n                    case 3: return [2 /*return*/, _e.sent()];\n                }\n            });\n        });\n    };\n    Authing.prototype.loginByPassCode = function (data) {\n        return __awaiter(this, void 0, void 0, function () {\n            var _data;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        if (data.passCodePayload.phone) {\n                            data.passCodePayload.phoneCountryCode =\n                                data.passCodePayload.phoneCountryCode || '+86';\n                        }\n                        _data = __assign(__assign({}, data), { connection: 'PASSCODE' });\n                        return [4 /*yield*/, this.login(_data, 'passCode')];\n                    case 1: return [2 /*return*/, _a.sent()];\n                }\n            });\n        });\n    };\n    Authing.prototype.logout = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var _a, loginStateError, loginState, _b, access_token, expires_at, _c, logoutError;\n            return __generator(this, function (_d) {\n                switch (_d.label) {\n                    case 0: return [4 /*yield*/, this.storage.remove((0,_helpers__WEBPACK_IMPORTED_MODULE_1__.getWxLoginCodeKey)(this.options.appId))];\n                    case 1:\n                        _d.sent();\n                        return [4 /*yield*/, this.getLoginState()];\n                    case 2:\n                        _a = __read.apply(void 0, [_d.sent(), 2]), loginStateError = _a[0], loginState = _a[1];\n                        if (loginStateError) {\n                            return [2 /*return*/, (0,_helpers_return__WEBPACK_IMPORTED_MODULE_0__.returnSuccess)(true)];\n                        }\n                        _b = loginState, access_token = _b.access_token, expires_at = _b.expires_at;\n                        if (!(!access_token || expires_at < Date.now())) return [3 /*break*/, 4];\n                        return [4 /*yield*/, this.clearLoginState()];\n                    case 3:\n                        _d.sent();\n                        return [2 /*return*/, (0,_helpers_return__WEBPACK_IMPORTED_MODULE_0__.returnSuccess)(true)];\n                    case 4: return [4 /*yield*/, (0,_helpers__WEBPACK_IMPORTED_MODULE_1__.request)({\n                            method: 'POST',\n                            url: this.options.host + \"/oidc/token/revocation\",\n                            data: {\n                                client_id: this.options.appId,\n                                token: access_token\n                            },\n                            header: {\n                                'content-type': 'application/x-www-form-urlencoded'\n                            }\n                        })];\n                    case 5:\n                        _c = __read.apply(void 0, [_d.sent(), 1]), logoutError = _c[0];\n                        if (logoutError) {\n                            return [2 /*return*/, (0,_helpers_return__WEBPACK_IMPORTED_MODULE_0__.returnError)(logoutError)];\n                        }\n                        return [4 /*yield*/, this.clearLoginState()];\n                    case 6:\n                        _d.sent();\n                        return [2 /*return*/, (0,_helpers_return__WEBPACK_IMPORTED_MODULE_0__.returnSuccess)(true)];\n                }\n            });\n        });\n    };\n    Authing.prototype.sendSms = function (data) {\n        return __awaiter(this, void 0, void 0, function () {\n            var _a, error, res;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        data.phoneCountryCode = data.phoneCountryCode || '+86';\n                        return [4 /*yield*/, (0,_helpers__WEBPACK_IMPORTED_MODULE_1__.request)({\n                                method: 'POST',\n                                url: this.options.host + \"/api/v3/send-sms\",\n                                data: data,\n                                header: {\n                                    'x-authing-userpool-id': this.options.userPoolId\n                                }\n                            })];\n                    case 1:\n                        _a = __read.apply(void 0, [_b.sent(), 2]), error = _a[0], res = _a[1];\n                        if (error) {\n                            return [2 /*return*/, (0,_helpers_return__WEBPACK_IMPORTED_MODULE_0__.returnError)(error)];\n                        }\n                        return [2 /*return*/, (0,_helpers_return__WEBPACK_IMPORTED_MODULE_0__.returnSuccess)(res)];\n                }\n            });\n        });\n    };\n    Authing.prototype.login = function (data, type) {\n        return __awaiter(this, void 0, void 0, function () {\n            var urlMap, _a, error, res, loginState;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        urlMap = {\n                            code: '/api/v3/signin-by-mobile',\n                            phone: '/api/v3/signin-by-mobile',\n                            password: '/api/v3/signin',\n                            passCode: '/api/v3/signin'\n                        };\n                        return [4 /*yield*/, (0,_helpers__WEBPACK_IMPORTED_MODULE_1__.request)({\n                                method: 'POST',\n                                url: this.options.host + urlMap[type],\n                                data: data,\n                                header: {\n                                    'x-authing-app-id': this.options.appId\n                                }\n                            })];\n                    case 1:\n                        _a = __read.apply(void 0, [_b.sent(), 2]), error = _a[0], res = _a[1];\n                        if (error) {\n                            return [2 /*return*/, (0,_helpers_return__WEBPACK_IMPORTED_MODULE_0__.returnError)(error)];\n                        }\n                        if (!(res.access_token || res.id_token)) return [3 /*break*/, 3];\n                        return [4 /*yield*/, this.saveLoginState(res)];\n                    case 2:\n                        loginState = _b.sent();\n                        return [2 /*return*/, (0,_helpers_return__WEBPACK_IMPORTED_MODULE_0__.returnSuccess)(loginState)];\n                    case 3: return [4 /*yield*/, this.clearLoginState()];\n                    case 4:\n                        _b.sent();\n                        return [2 /*return*/, (0,_helpers_return__WEBPACK_IMPORTED_MODULE_0__.returnError)(res)];\n                }\n            });\n        });\n    };\n    Authing.prototype.refreshToken = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var _a, error, loginState, _b, refresh_token, expires_at, data, _c, refreshTokenError, refreshTokenRes, newLoginState;\n            return __generator(this, function (_d) {\n                switch (_d.label) {\n                    case 0: return [4 /*yield*/, this.getLoginState()];\n                    case 1:\n                        _a = __read.apply(void 0, [_d.sent(), 2]), error = _a[0], loginState = _a[1];\n                        if (error) {\n                            return [2 /*return*/, (0,_helpers_return__WEBPACK_IMPORTED_MODULE_0__.returnError)({\n                                    message: 'refresh_token has expired, please login again'\n                                })];\n                        }\n                        _b = loginState, refresh_token = _b.refresh_token, expires_at = _b.expires_at;\n                        if (!refresh_token) {\n                            return [2 /*return*/, (0,_helpers_return__WEBPACK_IMPORTED_MODULE_0__.returnError)({\n                                    message: 'refresh_token must not be empty'\n                                })];\n                        }\n                        if (expires_at < Date.now()) {\n                            return [2 /*return*/, (0,_helpers_return__WEBPACK_IMPORTED_MODULE_0__.returnError)({\n                                    message: 'refresh_token has expired, please login again'\n                                })];\n                        }\n                        data = {\n                            grant_type: 'refresh_token',\n                            redirect_uri: '',\n                            refresh_token: refresh_token\n                        };\n                        return [4 /*yield*/, (0,_helpers__WEBPACK_IMPORTED_MODULE_1__.request)({\n                                method: 'POST',\n                                url: this.options.host + \"/oidc/token\",\n                                data: data,\n                                header: {\n                                    'content-type': 'application/x-www-form-urlencoded',\n                                    'x-authing-app-id': this.options.appId\n                                }\n                            })];\n                    case 2:\n                        _c = __read.apply(void 0, [_d.sent(), 2]), refreshTokenError = _c[0], refreshTokenRes = _c[1];\n                        if (refreshTokenError) {\n                            return [2 /*return*/, (0,_helpers_return__WEBPACK_IMPORTED_MODULE_0__.returnError)(refreshTokenError)];\n                        }\n                        return [4 /*yield*/, this.saveLoginState(refreshTokenRes)];\n                    case 3:\n                        newLoginState = _d.sent();\n                        return [2 /*return*/, (0,_helpers_return__WEBPACK_IMPORTED_MODULE_0__.returnSuccess)(newLoginState)];\n                }\n            });\n        });\n    };\n    Authing.prototype.updatePassword = function (data) {\n        return __awaiter(this, void 0, void 0, function () {\n            var _a, error, loginState, _b, access_token, expires_at, _c, publicKeyError, publicKey, _d, updatePasswordError, updatePasswordRes;\n            return __generator(this, function (_e) {\n                switch (_e.label) {\n                    case 0: return [4 /*yield*/, this.getLoginState()];\n                    case 1:\n                        _a = __read.apply(void 0, [_e.sent(), 2]), error = _a[0], loginState = _a[1];\n                        if (error) {\n                            return [2 /*return*/, (0,_helpers_return__WEBPACK_IMPORTED_MODULE_0__.returnError)({\n                                    message: 'Token has expired, please login again'\n                                })];\n                        }\n                        _b = loginState, access_token = _b.access_token, expires_at = _b.expires_at;\n                        if (expires_at < Date.now()) {\n                            return [2 /*return*/, (0,_helpers_return__WEBPACK_IMPORTED_MODULE_0__.returnError)({\n                                    message: 'Token has expired, please login again'\n                                })];\n                        }\n                        if (!(data.passwordEncryptType && data.passwordEncryptType !== 'none')) return [3 /*break*/, 3];\n                        if (!this.encryptFunction) {\n                            return [2 /*return*/, (0,_helpers_return__WEBPACK_IMPORTED_MODULE_0__.returnError)({\n                                    message: 'encryptFunction is required, if passwordEncryptType is not \"none\"'\n                                })];\n                        }\n                        return [4 /*yield*/, this.getPublicKey(data.passwordEncryptType)];\n                    case 2:\n                        _c = __read.apply(void 0, [_e.sent(), 2]), publicKeyError = _c[0], publicKey = _c[1];\n                        if (publicKeyError) {\n                            return [2 /*return*/, (0,_helpers_return__WEBPACK_IMPORTED_MODULE_0__.returnError)(publicKeyError)];\n                        }\n                        data.newPassword = this.encryptFunction(data.newPassword, publicKey);\n                        _e.label = 3;\n                    case 3: return [4 /*yield*/, (0,_helpers__WEBPACK_IMPORTED_MODULE_1__.request)({\n                            method: 'POST',\n                            url: this.options.host + \"/api/v3/update-password\",\n                            data: data,\n                            header: {\n                                'x-authing-userpool-id': this.options.userPoolId,\n                                Authorization: access_token\n                            }\n                        })];\n                    case 4:\n                        _d = __read.apply(void 0, [_e.sent(), 2]), updatePasswordError = _d[0], updatePasswordRes = _d[1];\n                        if (updatePasswordError) {\n                            return [2 /*return*/, (0,_helpers_return__WEBPACK_IMPORTED_MODULE_0__.returnError)(updatePasswordError)];\n                        }\n                        return [2 /*return*/, (0,_helpers_return__WEBPACK_IMPORTED_MODULE_0__.returnSuccess)(updatePasswordRes)];\n                }\n            });\n        });\n    };\n    Authing.prototype.getUserInfo = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var _a, error, loginState, _b, access_token, expires_at, _c, getProfileError, getProfileRes;\n            return __generator(this, function (_d) {\n                switch (_d.label) {\n                    case 0: return [4 /*yield*/, this.getLoginState()];\n                    case 1:\n                        _a = __read.apply(void 0, [_d.sent(), 2]), error = _a[0], loginState = _a[1];\n                        if (error) {\n                            return [2 /*return*/, (0,_helpers_return__WEBPACK_IMPORTED_MODULE_0__.returnError)({\n                                    message: 'Token has expired, please login again'\n                                })];\n                        }\n                        _b = loginState, access_token = _b.access_token, expires_at = _b.expires_at;\n                        if (expires_at < Date.now()) {\n                            return [2 /*return*/, (0,_helpers_return__WEBPACK_IMPORTED_MODULE_0__.returnError)({\n                                    message: 'Token has expired, please login again'\n                                })];\n                        }\n                        return [4 /*yield*/, (0,_helpers__WEBPACK_IMPORTED_MODULE_1__.request)({\n                                method: 'GET',\n                                url: this.options.host + \"/api/v3/get-profile\",\n                                header: {\n                                    'x-authing-userpool-id': this.options.userPoolId,\n                                    Authorization: access_token\n                                }\n                            })];\n                    case 2:\n                        _c = __read.apply(void 0, [_d.sent(), 2]), getProfileError = _c[0], getProfileRes = _c[1];\n                        if (getProfileError) {\n                            return [2 /*return*/, (0,_helpers_return__WEBPACK_IMPORTED_MODULE_0__.returnError)(getProfileError)];\n                        }\n                        return [2 /*return*/, (0,_helpers_return__WEBPACK_IMPORTED_MODULE_0__.returnSuccess)(getProfileRes)];\n                }\n            });\n        });\n    };\n    Authing.prototype.updateAvatar = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var res, uploadRes, parsedUploadRed, e_8;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        _a.trys.push([0, 4, , 5]);\n                        return [4 /*yield*/, _AuthingMove__WEBPACK_IMPORTED_MODULE_2__.AuthingMove.chooseImage({\n                                count: 1,\n                                sourceType: ['album', 'camera'],\n                                sizeType: ['original']\n                            })];\n                    case 1:\n                        res = _a.sent();\n                        return [4 /*yield*/, _AuthingMove__WEBPACK_IMPORTED_MODULE_2__.AuthingMove.uploadFile({\n                                url: this.options.host + \"/api/v2/upload?folder=avatar\",\n                                name: 'file',\n                                filePath: res.tempFiles[0].tempFilePath\n                            })];\n                    case 2:\n                        uploadRes = _a.sent();\n                        parsedUploadRed = JSON.parse(uploadRes.data);\n                        return [4 /*yield*/, this.updateUserInfo({\n                                photo: parsedUploadRed.data.url\n                            })];\n                    case 3:\n                        _a.sent();\n                        return [2 /*return*/, (0,_helpers_return__WEBPACK_IMPORTED_MODULE_0__.returnSuccess)(parsedUploadRed)];\n                    case 4:\n                        e_8 = _a.sent();\n                        return [2 /*return*/, (0,_helpers_return__WEBPACK_IMPORTED_MODULE_0__.returnError)({\n                                message: JSON.stringify(e_8)\n                            })];\n                    case 5: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    Authing.prototype.updateUserInfo = function (data) {\n        return __awaiter(this, void 0, void 0, function () {\n            var _a, error, loginState, _b, access_token, expires_at, _c, updateProfileError, updateProfileRes;\n            return __generator(this, function (_d) {\n                switch (_d.label) {\n                    case 0: return [4 /*yield*/, this.getLoginState()];\n                    case 1:\n                        _a = __read.apply(void 0, [_d.sent(), 2]), error = _a[0], loginState = _a[1];\n                        if (error) {\n                            return [2 /*return*/, (0,_helpers_return__WEBPACK_IMPORTED_MODULE_0__.returnError)({\n                                    message: 'Token has expired, please login again'\n                                })];\n                        }\n                        _b = loginState, access_token = _b.access_token, expires_at = _b.expires_at;\n                        if (expires_at < Date.now()) {\n                            return [2 /*return*/, (0,_helpers_return__WEBPACK_IMPORTED_MODULE_0__.returnError)({\n                                    message: 'Token has expired, please login again'\n                                })];\n                        }\n                        return [4 /*yield*/, (0,_helpers__WEBPACK_IMPORTED_MODULE_1__.request)({\n                                method: 'POST',\n                                url: this.options.host + \"/api/v3/update-profile\",\n                                data: data,\n                                header: {\n                                    'x-authing-userpool-id': this.options.userPoolId,\n                                    Authorization: access_token\n                                }\n                            })];\n                    case 2:\n                        _c = __read.apply(void 0, [_d.sent(), 2]), updateProfileError = _c[0], updateProfileRes = _c[1];\n                        if (updateProfileError) {\n                            return [2 /*return*/, (0,_helpers_return__WEBPACK_IMPORTED_MODULE_0__.returnError)(updateProfileError)];\n                        }\n                        return [2 /*return*/, (0,_helpers_return__WEBPACK_IMPORTED_MODULE_0__.returnSuccess)(updateProfileRes)];\n                }\n            });\n        });\n    };\n    Authing.prototype.getPhone = function (data) {\n        return __awaiter(this, void 0, void 0, function () {\n            var _a, getPhoneError, getPhoneRes;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0: return [4 /*yield*/, (0,_helpers__WEBPACK_IMPORTED_MODULE_1__.request)({\n                            method: 'POST',\n                            url: this.options.host + \"/api/v3/get-wechat-miniprogram-phone\",\n                            data: data,\n                            header: {\n                                'x-authing-userpool-id': this.options.userPoolId\n                            }\n                        })];\n                    case 1:\n                        _a = __read.apply(void 0, [_b.sent(), 2]), getPhoneError = _a[0], getPhoneRes = _a[1];\n                        if (getPhoneError) {\n                            return [2 /*return*/, (0,_helpers_return__WEBPACK_IMPORTED_MODULE_0__.returnError)(getPhoneError)];\n                        }\n                        return [2 /*return*/, (0,_helpers_return__WEBPACK_IMPORTED_MODULE_0__.returnSuccess)(getPhoneRes)];\n                }\n            });\n        });\n    };\n    return Authing;\n}());\n\n\n\n/***/ }),\n/* 6 */\n/***/ ((__unused_webpack_module, __authing_webpack_exports__, __authing_webpack_require__) => {\n\n__authing_webpack_require__.r(__authing_webpack_exports__);\n/* harmony export */ __authing_webpack_require__.d(__authing_webpack_exports__, {\n/* harmony export */   \"returnError\": () => (/* binding */ returnError),\n/* harmony export */   \"returnSuccess\": () => (/* binding */ returnSuccess)\n/* harmony export */ });\nfunction returnSuccess(data) {\n    return [null, data];\n}\nfunction returnError(errorData) {\n    return [errorData, undefined];\n}\n\n\n/***/ }),\n/* 7 */\n/***/ ((__unused_webpack_module, __authing_webpack_exports__, __authing_webpack_require__) => {\n\n__authing_webpack_require__.r(__authing_webpack_exports__);\n/* harmony export */ __authing_webpack_require__.d(__authing_webpack_exports__, {\n/* harmony export */   \"StorageProvider\": () => (/* reexport safe */ _StorageProvider__WEBPACK_IMPORTED_MODULE_0__.StorageProvider),\n/* harmony export */   \"getLoginStateKey\": () => (/* reexport safe */ _utils__WEBPACK_IMPORTED_MODULE_2__.getLoginStateKey),\n/* harmony export */   \"getWxLoginCodeKey\": () => (/* reexport safe */ _utils__WEBPACK_IMPORTED_MODULE_2__.getWxLoginCodeKey),\n/* harmony export */   \"request\": () => (/* reexport safe */ _request__WEBPACK_IMPORTED_MODULE_1__.request),\n/* harmony export */   \"returnError\": () => (/* reexport safe */ _return__WEBPACK_IMPORTED_MODULE_3__.returnError),\n/* harmony export */   \"returnSuccess\": () => (/* reexport safe */ _return__WEBPACK_IMPORTED_MODULE_3__.returnSuccess)\n/* harmony export */ });\n/* harmony import */ var _StorageProvider__WEBPACK_IMPORTED_MODULE_0__ = __authing_webpack_require__(8);\n/* harmony import */ var _request__WEBPACK_IMPORTED_MODULE_1__ = __authing_webpack_require__(24);\n/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_2__ = __authing_webpack_require__(26);\n/* harmony import */ var _return__WEBPACK_IMPORTED_MODULE_3__ = __authing_webpack_require__(6);\n\n\n\n\n\n\n/***/ }),\n/* 8 */\n/***/ ((__unused_webpack_module, __authing_webpack_exports__, __authing_webpack_require__) => {\n\n__authing_webpack_require__.r(__authing_webpack_exports__);\n/* harmony export */ __authing_webpack_require__.d(__authing_webpack_exports__, {\n/* harmony export */   \"StorageProvider\": () => (/* binding */ StorageProvider)\n/* harmony export */ });\n/* harmony import */ var _AuthingMove__WEBPACK_IMPORTED_MODULE_0__ = __authing_webpack_require__(9);\n\nvar StorageProvider = /** @class */ (function () {\n    function StorageProvider() {\n    }\n    StorageProvider.prototype.get = function (key) {\n        return _AuthingMove__WEBPACK_IMPORTED_MODULE_0__.AuthingMove.getStorage({\n            key: key\n        });\n    };\n    StorageProvider.prototype.set = function (key, data) {\n        return _AuthingMove__WEBPACK_IMPORTED_MODULE_0__.AuthingMove.setStorage({\n            key: key,\n            data: data\n        });\n    };\n    StorageProvider.prototype.remove = function (key) {\n        return _AuthingMove__WEBPACK_IMPORTED_MODULE_0__.AuthingMove.removeStorage({\n            key: key\n        });\n    };\n    return StorageProvider;\n}());\n\n\n\n/***/ }),\n/* 9 */\n/***/ ((__unused_webpack_module, __authing_webpack_exports__, __authing_webpack_require__) => {\n\n__authing_webpack_require__.r(__authing_webpack_exports__);\n/* harmony export */ __authing_webpack_require__.d(__authing_webpack_exports__, {\n/* harmony export */   \"AuthingMove\": () => (/* reexport safe */ _authing_authingmove_core__WEBPACK_IMPORTED_MODULE_0__[\"default\"])\n/* harmony export */ });\n/* harmony import */ var _authing_authingmove_core__WEBPACK_IMPORTED_MODULE_0__ = __authing_webpack_require__(1);\n/* harmony import */ var _authing_authingmove_api_proxy__WEBPACK_IMPORTED_MODULE_1__ = __authing_webpack_require__(10);\n\n\n_authing_authingmove_core__WEBPACK_IMPORTED_MODULE_0__[\"default\"].use(_authing_authingmove_api_proxy__WEBPACK_IMPORTED_MODULE_1__[\"default\"]);\n\n\n\n/***/ }),\n/* 10 */\n/***/ ((__unused_webpack_module, __authing_webpack_exports__, __authing_webpack_require__) => {\n\n__authing_webpack_require__.r(__authing_webpack_exports__);\n/* harmony export */ __authing_webpack_require__.d(__authing_webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ install)\n/* harmony export */ });\n/* harmony import */ var _transform__WEBPACK_IMPORTED_MODULE_0__ = __authing_webpack_require__(11);\n/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_1__ = __authing_webpack_require__(12);\n/* harmony import */ var _promisify__WEBPACK_IMPORTED_MODULE_2__ = __authing_webpack_require__(23);\n\n\n\n\nfunction install (AuthingMove, options = {}) {\n  const {\n    custom = {} // custom transform rules\n  } = options\n  const from = \"wx\" || 0\n  const to = \"wx\" || 0\n\n  const transformedApis = (0,_transform__WEBPACK_IMPORTED_MODULE_0__[\"default\"])({\n    from,\n    to,\n    custom\n  })\n\n  // reserve some expansion space\n  const apis = Object.assign({}, transformedApis, (0,_promisify__WEBPACK_IMPORTED_MODULE_2__.promisify)(transformedApis))\n\n  Object.keys(apis).forEach(api => {\n    try {\n      if (typeof apis[api] !== 'function') {\n        AuthingMove[api] = apis[api]\n        return\n      }\n\n      AuthingMove[api] = (...args) => apis[api].apply(AuthingMove, args)\n    } catch (e) {\n      (0,_utils__WEBPACK_IMPORTED_MODULE_1__.error)(`Call ${AuthingMove}.${api} error:` + JSON.stringify(e))\n    }\n  })\n}\n\n\n/***/ }),\n/* 11 */\n/***/ ((__unused_webpack_module, __authing_webpack_exports__, __authing_webpack_require__) => {\n\n__authing_webpack_require__.r(__authing_webpack_exports__);\n/* harmony export */ __authing_webpack_require__.d(__authing_webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ transformApi)\n/* harmony export */ });\n/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_0__ = __authing_webpack_require__(12);\n/* harmony import */ var _apis__WEBPACK_IMPORTED_MODULE_1__ = __authing_webpack_require__(14);\n\n\n\nconst fromMap = (0,_utils__WEBPACK_IMPORTED_MODULE_0__.generateFromMap)()\n\nfunction joinName (from = '', to = '') {\n  const _from = `__authing_move_src_mode_${from}__`\n  return `${fromMap[_from]}_${to}`\n}\n\nfunction transformApi (options) {\n  const envContext = (0,_utils__WEBPACK_IMPORTED_MODULE_0__.getEnvContext)()\n  const needProxy = Object.create(null)\n\n  Object.keys(_apis__WEBPACK_IMPORTED_MODULE_1__).forEach(key => {\n    needProxy[key] = envContext[key] || _apis__WEBPACK_IMPORTED_MODULE_1__[key]\n  })\n\n  const apis = Object.create(null)\n\n  Object.keys(needProxy).forEach(api => {\n    if (typeof needProxy[api] !== 'function') {\n      apis[api] = needProxy[api]\n      return\n    }\n\n    apis[api] = (...args) => {\n      let from = options.from\n      const to = options.to\n\n      if (args.length) {\n        from = args.pop()\n\n        if (typeof from !== 'string' || !fromMap[from]) {\n          args.push(from)\n          from = options.from\n        }\n      }\n\n      const fromTo = joinName(from, to)\n\n      if (options.custom[fromTo] && options.custom[fromTo][api]) {\n        return options.custom[fromTo][api].apply(this, args)\n      }\n\n      if (_apis__WEBPACK_IMPORTED_MODULE_1__[api]) {\n        return _apis__WEBPACK_IMPORTED_MODULE_1__[api].apply(this, args)\n      }\n\n      if (envContext[api]) {\n        return envContext[api].apply(this, args)\n      }\n\n      (0,_utils__WEBPACK_IMPORTED_MODULE_0__.error)(`\"${api}\" method does not exist in the current context`)\n    }\n  })\n\n  return apis\n}\n\n\n/***/ }),\n/* 12 */\n/***/ ((__unused_webpack_module, __authing_webpack_exports__, __authing_webpack_require__) => {\n\n__authing_webpack_require__.r(__authing_webpack_exports__);\n/* harmony export */ __authing_webpack_require__.d(__authing_webpack_exports__, {\n/* harmony export */   \"adaptOptions\": () => (/* binding */ adaptOptions),\n/* harmony export */   \"error\": () => (/* binding */ error),\n/* harmony export */   \"generateFromMap\": () => (/* binding */ generateFromMap),\n/* harmony export */   \"getEnvContext\": () => (/* reexport safe */ _runtime_env__WEBPACK_IMPORTED_MODULE_0__.getEnvContext),\n/* harmony export */   \"handleSuccess\": () => (/* binding */ handleSuccess),\n/* harmony export */   \"makeMap\": () => (/* binding */ makeMap),\n/* harmony export */   \"noop\": () => (/* binding */ noop),\n/* harmony export */   \"transformTempFiles\": () => (/* binding */ transformTempFiles),\n/* harmony export */   \"warn\": () => (/* binding */ warn)\n/* harmony export */ });\n/* harmony import */ var _runtime_env__WEBPACK_IMPORTED_MODULE_0__ = __authing_webpack_require__(13);\n\n\nfunction generateFromMap () {\n  const platforms = ['wx', 'ali', 'baidu', 'qq', 'tt', 'jd', 'ks', 'qa_webview', 'qa_ux', 'Mpx', 'Taro', 'uni']\n  return platforms.reduce((map, platform) => {\n    map[`__authing_move_src_mode_${platform}__`] = platform\n    return map\n  }, {})\n}\n\nfunction makeMap (arr) {\n  return arr.reduce((map, item) => {\n    map[item] = true\n    return map\n  }, {})\n}\n\nfunction warn (message) {\n  console.warn && console.warn(`[AuthingMove/api-proxy warn in \"${\"wx\"}\"]:\\n ${message}`)\n}\n\nfunction error (message) {\n  console.error && console.error(`[AuthingMove/api-proxy error in \"${\"wx\"}\"]:\\n ${message}`)\n}\n\nfunction noop () {}\n\nfunction adaptOptions (originalOptions, matchedOptions = {}, extraOptions = {}) {\n  let options = {}\n\n  Object.keys(originalOptions).forEach(key => {\n    const _key = matchedOptions.hasOwnProperty(key) ? matchedOptions[key] : key\n    if (_key) {\n      options[_key] = originalOptions[key]\n    }\n  })\n\n  options = Object.assign({}, options, extraOptions)\n\n  return options\n}\n\nfunction handleSuccess (originalOptions, wrappedSuccess = noop, context) {\n  if (!originalOptions.success) {\n    return\n  }\n\n  const _this = context || this\n  const cachedSuccess = originalOptions.success\n\n  originalOptions.success = res => cachedSuccess.call(_this, wrappedSuccess(res) || res)\n}\n\nfunction transformTempFiles (tempFiles) {\n  return tempFiles.map(file => {\n    return {\n      ...file,\n      tempFilePath: file.path\n    }\n  })\n}\n\n\n/***/ }),\n/* 13 */\n/***/ ((__unused_webpack_module, __authing_webpack_exports__, __authing_webpack_require__) => {\n\n__authing_webpack_require__.r(__authing_webpack_exports__);\n/* harmony export */ __authing_webpack_require__.d(__authing_webpack_exports__, {\n/* harmony export */   \"getEnvContext\": () => (/* binding */ getEnvContext)\n/* harmony export */ });\nfunction getEnvContext () {\n  const noopEnv = {}\n\n  switch (\"wx\") {\n  case 'wx':\n  case 'Mpx':\n    return wx\n  case 'ali':\n    return my\n  case 'baidu':\n    return swan\n  case 'qq':\n    return qq\n  case 'tt':\n    return tt\n  case 'jd':\n    return jd\n  case 'ks':\n    return ks\n  case 'qa_webview':\n    return qa\n  case 'qa_ux':\n    return noopEnv\n  case 'Taro':\n    return Taro\n  case 'uni':\n    return uni\n  }\n}\n\n\n/***/ }),\n/* 14 */\n/***/ ((__unused_webpack_module, __authing_webpack_exports__, __authing_webpack_require__) => {\n\n__authing_webpack_require__.r(__authing_webpack_exports__);\n/* harmony export */ __authing_webpack_require__.d(__authing_webpack_exports__, {\n/* harmony export */   \"checkSession\": () => (/* reexport safe */ _checkSession_checkSession__WEBPACK_IMPORTED_MODULE_7__.checkSession),\n/* harmony export */   \"chooseImage\": () => (/* reexport safe */ _image_image__WEBPACK_IMPORTED_MODULE_4__.chooseImage),\n/* harmony export */   \"clearStorage\": () => (/* reexport safe */ _storage_storage__WEBPACK_IMPORTED_MODULE_3__.clearStorage),\n/* harmony export */   \"getStorage\": () => (/* reexport safe */ _storage_storage__WEBPACK_IMPORTED_MODULE_3__.getStorage),\n/* harmony export */   \"getUserProfile\": () => (/* reexport safe */ _userInfo_getUserProfile__WEBPACK_IMPORTED_MODULE_6__.getUserProfile),\n/* harmony export */   \"login\": () => (/* reexport safe */ _login_login__WEBPACK_IMPORTED_MODULE_0__.login),\n/* harmony export */   \"removeStorage\": () => (/* reexport safe */ _storage_storage__WEBPACK_IMPORTED_MODULE_3__.removeStorage),\n/* harmony export */   \"request\": () => (/* reexport safe */ _request_request__WEBPACK_IMPORTED_MODULE_1__.request),\n/* harmony export */   \"scanCode\": () => (/* reexport safe */ _scan_scan__WEBPACK_IMPORTED_MODULE_2__.scanCode),\n/* harmony export */   \"setStorage\": () => (/* reexport safe */ _storage_storage__WEBPACK_IMPORTED_MODULE_3__.setStorage),\n/* harmony export */   \"uploadFile\": () => (/* reexport safe */ _upload_upload__WEBPACK_IMPORTED_MODULE_5__.uploadFile)\n/* harmony export */ });\n/* harmony import */ var _login_login__WEBPACK_IMPORTED_MODULE_0__ = __authing_webpack_require__(15);\n/* harmony import */ var _request_request__WEBPACK_IMPORTED_MODULE_1__ = __authing_webpack_require__(16);\n/* harmony import */ var _scan_scan__WEBPACK_IMPORTED_MODULE_2__ = __authing_webpack_require__(17);\n/* harmony import */ var _storage_storage__WEBPACK_IMPORTED_MODULE_3__ = __authing_webpack_require__(18);\n/* harmony import */ var _image_image__WEBPACK_IMPORTED_MODULE_4__ = __authing_webpack_require__(19);\n/* harmony import */ var _upload_upload__WEBPACK_IMPORTED_MODULE_5__ = __authing_webpack_require__(20);\n/* harmony import */ var _userInfo_getUserProfile__WEBPACK_IMPORTED_MODULE_6__ = __authing_webpack_require__(21);\n/* harmony import */ var _checkSession_checkSession__WEBPACK_IMPORTED_MODULE_7__ = __authing_webpack_require__(22);\n\n\n\n\n\n\n\n\n\n\n/***/ }),\n/* 15 */\n/***/ ((__unused_webpack_module, __authing_webpack_exports__, __authing_webpack_require__) => {\n\n__authing_webpack_require__.r(__authing_webpack_exports__);\n/* harmony export */ __authing_webpack_require__.d(__authing_webpack_exports__, {\n/* harmony export */   \"login\": () => (/* binding */ login)\n/* harmony export */ });\n/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_0__ = __authing_webpack_require__(12);\n\n\nconst envContext = (0,_utils__WEBPACK_IMPORTED_MODULE_0__.getEnvContext)()\n\nfunction login (options = {}) {\n  return envContext.login(options)\n}\n\n\n/***/ }),\n/* 16 */\n/***/ ((__unused_webpack_module, __authing_webpack_exports__, __authing_webpack_require__) => {\n\n__authing_webpack_require__.r(__authing_webpack_exports__);\n/* harmony export */ __authing_webpack_require__.d(__authing_webpack_exports__, {\n/* harmony export */   \"request\": () => (/* binding */ request)\n/* harmony export */ });\n/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_0__ = __authing_webpack_require__(12);\n\n\nconst envContext = (0,_utils__WEBPACK_IMPORTED_MODULE_0__.getEnvContext)()\n\nfunction request (options = {}) {\n  return envContext.request(options)\n}\n\n\n/***/ }),\n/* 17 */\n/***/ ((__unused_webpack_module, __authing_webpack_exports__, __authing_webpack_require__) => {\n\n__authing_webpack_require__.r(__authing_webpack_exports__);\n/* harmony export */ __authing_webpack_require__.d(__authing_webpack_exports__, {\n/* harmony export */   \"scanCode\": () => (/* binding */ scanCode)\n/* harmony export */ });\n/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_0__ = __authing_webpack_require__(12);\n\n\nconst envContext = (0,_utils__WEBPACK_IMPORTED_MODULE_0__.getEnvContext)()\n\nfunction scanCode (options = {}) {\n  return envContext.scanCode(options)\n}\n\n\n/***/ }),\n/* 18 */\n/***/ ((__unused_webpack_module, __authing_webpack_exports__, __authing_webpack_require__) => {\n\n__authing_webpack_require__.r(__authing_webpack_exports__);\n/* harmony export */ __authing_webpack_require__.d(__authing_webpack_exports__, {\n/* harmony export */   \"clearStorage\": () => (/* binding */ clearStorage),\n/* harmony export */   \"getStorage\": () => (/* binding */ getStorage),\n/* harmony export */   \"removeStorage\": () => (/* binding */ removeStorage),\n/* harmony export */   \"setStorage\": () => (/* binding */ setStorage)\n/* harmony export */ });\n/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_0__ = __authing_webpack_require__(12);\n\n\nconst envContext = (0,_utils__WEBPACK_IMPORTED_MODULE_0__.getEnvContext)()\n\nfunction setStorage (options = {}) {\n  const _options = (0,_utils__WEBPACK_IMPORTED_MODULE_0__.adaptOptions)(options, {}, {\n    encrypt: false\n  })\n  return envContext.setStorage(_options)\n}\n\nfunction getStorage (options = {}) {\n  const _options = (0,_utils__WEBPACK_IMPORTED_MODULE_0__.adaptOptions)(options, {}, {\n    encrypt: false\n  })\n  return envContext.getStorage(_options)\n}\n\nfunction removeStorage (options = {}) {\n  return envContext.removeStorage(options)\n}\n\nfunction clearStorage (options = {}) {\n  return envContext.clearStorage(options)\n}\n\n\n/***/ }),\n/* 19 */\n/***/ ((__unused_webpack_module, __authing_webpack_exports__, __authing_webpack_require__) => {\n\n__authing_webpack_require__.r(__authing_webpack_exports__);\n/* harmony export */ __authing_webpack_require__.d(__authing_webpack_exports__, {\n/* harmony export */   \"chooseImage\": () => (/* binding */ chooseImage)\n/* harmony export */ });\n/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_0__ = __authing_webpack_require__(12);\n\n\nconst envContext = (0,_utils__WEBPACK_IMPORTED_MODULE_0__.getEnvContext)()\n\nfunction chooseImage (options = {}) {\n  return envContext.chooseMedia(options)\n}\n\n\n/***/ }),\n/* 20 */\n/***/ ((__unused_webpack_module, __authing_webpack_exports__, __authing_webpack_require__) => {\n\n__authing_webpack_require__.r(__authing_webpack_exports__);\n/* harmony export */ __authing_webpack_require__.d(__authing_webpack_exports__, {\n/* harmony export */   \"uploadFile\": () => (/* binding */ uploadFile)\n/* harmony export */ });\n/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_0__ = __authing_webpack_require__(12);\n\n\nconst envContext = (0,_utils__WEBPACK_IMPORTED_MODULE_0__.getEnvContext)()\n\nfunction uploadFile (options = {}) {\n  return envContext.uploadFile(options)\n}\n\n\n/***/ }),\n/* 21 */\n/***/ ((__unused_webpack_module, __authing_webpack_exports__, __authing_webpack_require__) => {\n\n__authing_webpack_require__.r(__authing_webpack_exports__);\n/* harmony export */ __authing_webpack_require__.d(__authing_webpack_exports__, {\n/* harmony export */   \"getUserProfile\": () => (/* binding */ getUserProfile)\n/* harmony export */ });\n/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_0__ = __authing_webpack_require__(12);\n\n\nconst envContext = (0,_utils__WEBPACK_IMPORTED_MODULE_0__.getEnvContext)()\n\nfunction getUserProfile (options = {}) {\n  return envContext.getUserProfile(options)\n}\n\n\n/***/ }),\n/* 22 */\n/***/ ((__unused_webpack_module, __authing_webpack_exports__, __authing_webpack_require__) => {\n\n__authing_webpack_require__.r(__authing_webpack_exports__);\n/* harmony export */ __authing_webpack_require__.d(__authing_webpack_exports__, {\n/* harmony export */   \"checkSession\": () => (/* binding */ checkSession)\n/* harmony export */ });\n/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_0__ = __authing_webpack_require__(12);\n\n\nconst envContext = (0,_utils__WEBPACK_IMPORTED_MODULE_0__.getEnvContext)()\n\nfunction checkSession (options = {}) {\n  return envContext.checkSession(options)\n}\n\n\n/***/ }),\n/* 23 */\n/***/ ((__unused_webpack_module, __authing_webpack_exports__, __authing_webpack_require__) => {\n\n__authing_webpack_require__.r(__authing_webpack_exports__);\n/* harmony export */ __authing_webpack_require__.d(__authing_webpack_exports__, {\n/* harmony export */   \"promisify\": () => (/* binding */ promisify)\n/* harmony export */ });\n/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_0__ = __authing_webpack_require__(12);\n\n\nconst envContext = (0,_utils__WEBPACK_IMPORTED_MODULE_0__.getEnvContext)()\n\nfunction promisify (apis) {\n  const fromMap = (0,_utils__WEBPACK_IMPORTED_MODULE_0__.generateFromMap)()\n\n  return Object.keys(apis).reduce((map, key) => {\n    if (typeof apis[key] !== 'function') {\n      return map\n    }\n\n    map[key] = function (...args) {\n      if (promisifyFilter(key)) {\n        return apis[key].apply(apis, args)\n      }\n\n      if (!args[0] || fromMap[args[0]]) {\n        args.unshift({\n          success: _utils__WEBPACK_IMPORTED_MODULE_0__.noop,\n          fail: _utils__WEBPACK_IMPORTED_MODULE_0__.noop\n        })\n      }\n\n      const options = args[0]\n      let returned\n\n      const promise = new Promise((resolve, reject) => {\n        const originalSuccess = options.success\n        const originalFail = options.fail\n\n        options.success = function success (res) {\n          originalSuccess && originalSuccess.call(this, res)\n          resolve(res)\n        }\n\n        options.fail = function fail (res) {\n          originalFail && originalFail.call(this, res)\n          reject(res)\n        }\n\n        returned = apis[key].apply(envContext, args)\n      })\n\n      promise.__returned = returned\n      return promise\n    }\n\n    return map\n  }, {})\n}\n\nfunction promisifyFilter (key) {\n  return /^get\\w*Manager$/.test(key) ||\n    /^create\\w*Context$/.test(key) ||\n    /^(on|off)/.test(key) ||\n    /\\w+Sync$/.test(key)\n}\n\n\n/***/ }),\n/* 24 */\n/***/ ((__unused_webpack_module, __authing_webpack_exports__, __authing_webpack_require__) => {\n\n__authing_webpack_require__.r(__authing_webpack_exports__);\n/* harmony export */ __authing_webpack_require__.d(__authing_webpack_exports__, {\n/* harmony export */   \"request\": () => (/* binding */ request)\n/* harmony export */ });\n/* harmony import */ var _AuthingMove__WEBPACK_IMPORTED_MODULE_0__ = __authing_webpack_require__(9);\n/* harmony import */ var _package_json__WEBPACK_IMPORTED_MODULE_1__ = __authing_webpack_require__(25);\n/* harmony import */ var _return__WEBPACK_IMPORTED_MODULE_2__ = __authing_webpack_require__(6);\nvar __assign = (undefined && undefined.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (undefined && undefined.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\n\n\n\nvar ResponseDataType;\n(function (ResponseDataType) {\n    ResponseDataType[ResponseDataType[\"NOT_INTERCEPTED_SUCCESS\"] = 0] = \"NOT_INTERCEPTED_SUCCESS\";\n    ResponseDataType[ResponseDataType[\"NOT_INTERCEPTED_ERROR\"] = 1] = \"NOT_INTERCEPTED_ERROR\";\n    ResponseDataType[ResponseDataType[\"INTERCEPTED_SUCCESS\"] = 2] = \"INTERCEPTED_SUCCESS\";\n    ResponseDataType[ResponseDataType[\"INTERCEPTED_ERROR\"] = 3] = \"INTERCEPTED_ERROR\";\n})(ResponseDataType || (ResponseDataType = {}));\nfunction request(options) {\n    return __awaiter(this, void 0, void 0, function () {\n        var _options, data, interceptRes, e_1;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    _a.trys.push([0, 2, , 3]);\n                    _options = Object.assign({}, options, {\n                        header: __assign(__assign({}, options.header), { 'x-authing-request-from': 'sdk-miniapp', 'x-authing-sdk-version': _package_json__WEBPACK_IMPORTED_MODULE_1__.version })\n                    });\n                    return [4 /*yield*/, _AuthingMove__WEBPACK_IMPORTED_MODULE_0__.AuthingMove.request(_options)];\n                case 1:\n                    data = (_a.sent()).data;\n                    interceptRes = interceptResponseData(options.url, data);\n                    switch (interceptRes) {\n                        case ResponseDataType.NOT_INTERCEPTED_SUCCESS:\n                            return [2 /*return*/, (0,_return__WEBPACK_IMPORTED_MODULE_2__.returnSuccess)(data.data || data)];\n                        case ResponseDataType.INTERCEPTED_SUCCESS:\n                            return [2 /*return*/, (0,_return__WEBPACK_IMPORTED_MODULE_2__.returnSuccess)(data)];\n                        default:\n                            return [2 /*return*/, (0,_return__WEBPACK_IMPORTED_MODULE_2__.returnError)(data)];\n                    }\n                    return [3 /*break*/, 3];\n                case 2:\n                    e_1 = _a.sent();\n                    return [2 /*return*/, (0,_return__WEBPACK_IMPORTED_MODULE_2__.returnError)({\n                            message: JSON.stringify(e_1)\n                        })];\n                case 3: return [2 /*return*/];\n            }\n        });\n    });\n}\nfunction interceptResponseData(url, data) {\n    var intercepts = [\n        {\n            test: /(\\/api\\/v3\\/system)$/,\n            validate: function () {\n                if (data.rsa || data.sm2) {\n                    return true;\n                }\n                return false;\n            }\n        },\n        {\n            test: /(\\/oidc\\/token)$/,\n            validate: function () {\n                if (data.access_token || data.id_token) {\n                    return true;\n                }\n                return false;\n            }\n        },\n        {\n            test: /(\\/oidc\\/token\\/revocation)$/,\n            validate: function () {\n                return data === '';\n            }\n        }\n    ];\n    for (var i = 0; i < intercepts.length; i++) {\n        var matched = url.match(intercepts[i].test);\n        if (matched && matched[0]) {\n            if (intercepts[i].validate()) {\n                return ResponseDataType.INTERCEPTED_SUCCESS;\n            }\n            return ResponseDataType.INTERCEPTED_ERROR;\n        }\n    }\n    if (data.statusCode === 200) {\n        return ResponseDataType.NOT_INTERCEPTED_SUCCESS;\n    }\n    return ResponseDataType.NOT_INTERCEPTED_ERROR;\n}\n\n\n/***/ }),\n/* 25 */\n/***/ ((module) => {\n\nmodule.exports = JSON.parse('{\"name\":\"@authing/miniapp\",\"version\":\"5.1.1\",\"description\":\"Authing miniapp sdk source code\",\"main\":\"src/index.ts\",\"module\":\"src/index.ts\",\"scripts\":{\"autoinstall\":\"npm ci\",\"dev\":\"node ./scripts/build.js watch\",\"build\":\"node ./scripts/build.js\",\"release:official\":\"npm publish --verbose --access public\",\"release:alpha\":\"npm publish --verbose --tag=alpha --access public\"},\"dependencies\":{\"@authing/authingmove-api-proxy\":\"^1.0.1-alpha.14\",\"@authing/authingmove-core\":\"^1.0.1-alpha.14\"},\"devDependencies\":{\"@authing/authingmove-webpack-plugin\":\"^1.0.1-alpha.14\"},\"repository\":{\"type\":\"git\",\"url\":\"git+https://github.com/Authing/authing-js-sdk.git\"},\"author\":\"https://github.com/authing\",\"license\":\"MIT\",\"bugs\":{\"url\":\"https://github.com/Authing/authing-js-sdk/issues\"},\"homepage\":\"https://github.com/Authing/authing-js-sdk#readme\",\"publishConfig\":{\"access\":\"public\",\"registry\":\"https://registry.npmjs.org\"}}');\n\n/***/ }),\n/* 26 */\n/***/ ((__unused_webpack_module, __authing_webpack_exports__, __authing_webpack_require__) => {\n\n__authing_webpack_require__.r(__authing_webpack_exports__);\n/* harmony export */ __authing_webpack_require__.d(__authing_webpack_exports__, {\n/* harmony export */   \"getLoginStateKey\": () => (/* binding */ getLoginStateKey),\n/* harmony export */   \"getWxLoginCodeKey\": () => (/* binding */ getWxLoginCodeKey)\n/* harmony export */ });\nfunction getLoginStateKey(appId) {\n    return ['authing', appId, 'login-state'].join(':');\n}\nfunction getWxLoginCodeKey(appId) {\n    return ['authing', appId, 'wx-login-code'].join(':');\n}\n\n\n/***/ }),\n/* 27 */\n/***/ ((__unused_webpack_module, __authing_webpack_exports__, __authing_webpack_require__) => {\n\n__authing_webpack_require__.r(__authing_webpack_exports__);\n\n\n\n/***/ })\n/******/ ]);\n/************************************************************************/\n/******/ // The module cache\n/******/ var __webpack_module_cache__ = {};\n/******/ \n/******/ // The require function\n/******/ function __authing_webpack_require__(moduleId) {\n/******/ \t// Check if module is in cache\n/******/ \tvar cachedModule = __webpack_module_cache__[moduleId];\n/******/ \tif (cachedModule !== undefined) {\n/******/ \t\treturn cachedModule.exports;\n/******/ \t}\n/******/ \t// Create a new module (and put it into the cache)\n/******/ \tvar module = __webpack_module_cache__[moduleId] = {\n/******/ \t\t// no module.id needed\n/******/ \t\t// no module.loaded needed\n/******/ \t\texports: {}\n/******/ \t};\n/******/ \n/******/ \t// Execute the module function\n/******/ \t__webpack_modules__[moduleId](module, module.exports, __authing_webpack_require__);\n/******/ \n/******/ \t// Return the exports of the module\n/******/ \treturn module.exports;\n/******/ }\n/******/ \n/************************************************************************/\n/******/ /* webpack/runtime/define property getters */\n/******/ (() => {\n/******/ \t// define getter functions for harmony exports\n/******/ \t__authing_webpack_require__.d = (exports, definition) => {\n/******/ \t\tfor(var key in definition) {\n/******/ \t\t\tif(__authing_webpack_require__.o(definition, key) && !__authing_webpack_require__.o(exports, key)) {\n/******/ \t\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n/******/ \t\t\t}\n/******/ \t\t}\n/******/ \t};\n/******/ })();\n/******/ \n/******/ /* webpack/runtime/hasOwnProperty shorthand */\n/******/ (() => {\n/******/ \t__authing_webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))\n/******/ })();\n/******/ \n/******/ /* webpack/runtime/make namespace object */\n/******/ (() => {\n/******/ \t// define __esModule on exports\n/******/ \t__authing_webpack_require__.r = (exports) => {\n/******/ \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n/******/ \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n/******/ \t\t}\n/******/ \t\tObject.defineProperty(exports, '__esModule', { value: true });\n/******/ \t};\n/******/ })();\n/******/ \n/************************************************************************/\nvar __authing_webpack_exports__ = {};\n// This entry need to be wrapped in an IIFE because it need to be isolated against other modules in the chunk.\n(() => {\n__authing_webpack_require__.r(__authing_webpack_exports__);\n/* harmony export */ __authing_webpack_require__.d(__authing_webpack_exports__, {\n/* harmony export */   \"Authing\": () => (/* reexport safe */ _Authing__WEBPACK_IMPORTED_MODULE_1__.Authing)\n/* harmony export */ });\n/* harmony import */ var _authing_authingmove_core__WEBPACK_IMPORTED_MODULE_0__ = __authing_webpack_require__(1);\n/* harmony import */ var _Authing__WEBPACK_IMPORTED_MODULE_1__ = __authing_webpack_require__(5);\n/* harmony import */ var _types__WEBPACK_IMPORTED_MODULE_2__ = __authing_webpack_require__(27);\n\n\n\n\n})();\n\nvar __authing_webpack_exports__Authing = __authing_webpack_exports__.Authing;\nif (!exports.__esModule) Object.defineProperty(exports, \"__esModule\", { value: true });Object.defineProperty(exports, 'Authing', { enumerable: true, configurable: true, get: function() { return __authing_webpack_exports__Authing; } });\n"]}